clang++ -std=c++14 -stdlib=libc++ -O3 -ferror-limit=2 -Weverything -Wno-c++98-compat -Wno-c++98-compat-pedantic -Wno-sign-conversion -Wno-exit-time-destructors -Wno-float-equal -Wno-global-constructors -Wno-missing-declarations -Wno-unused-parameter -Wno-padded -Wno-shadow -Wno-weak-vtables -Wno-missing-prototypes -Wno-unused-variable -ferror-limit=1 -Wno-deprecated -Wno-conversion -Wno-double-promotion -c src/direct_cuda_pattern.cc -o ./obj/direct_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1
nvcc src/cuda_pattern.cu -o ./obj/_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1 -m64 -dc -gencode arch=compute_70,code=sm_70 --relocatable-device-code true  -Xptxas -v
ptxas info    : 9754 bytes gmem
ptxas info    : Compiling entry function '_Z5ZaxpymddP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZaxpymddP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 392 bytes cmem[0]
ptxas info    : Function properties for cudaGetDevice
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5DasummP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z5DasummP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 26 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z8sum_diagP7double2mdd' for 'sm_70'
ptxas info    : Function properties for _Z8sum_diagP7double2mdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 10 registers, 384 bytes cmem[0]
ptxas info    : Compiling entry function '_Z5ZgemmP7double2S0_S0_md' for 'sm_70'
ptxas info    : Function properties for _Z5ZgemmP7double2S0_S0_md
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 40 registers, 8704 bytes smem, 392 bytes cmem[0]
ptxas info    : Function properties for cudaFuncGetAttributes
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z22extract_intensity_diffP7double2PdS1_mm' for 'sm_70'
ptxas info    : Function properties for _Z22extract_intensity_diffP7double2PdS1_mm
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 392 bytes cmem[0], 8 bytes cmem[2]
ptxas info    : Compiling entry function '_Z9compose_aPdPmS_dP7double2m' for 'sm_70'
ptxas info    : Function properties for _Z9compose_aPdPmS_dP7double2m
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 400 bytes cmem[0]
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessor
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5ZscalmdP7double2' for 'sm_70'
ptxas info    : Function properties for _Z5ZscalmdP7double2
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 27 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaMalloc
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm' for 'sm_70'
ptxas info    : Function properties for _Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm
    24 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 72 registers, 448 bytes cmem[0], 104 bytes cmem[2]
ptxas info    : Compiling entry function '_Z5ZcopymP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZcopymP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaDeviceGetAttribute
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z6Dznrm2mP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z6Dznrm2mP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd' for 'sm_70'
ptxas info    : Function properties for _Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 416 bytes cmem[0], 8 bytes cmem[2]
nvcc -dlink ./obj/_cuda_pattern.o -arch=sm_70 -o ./obj/cuda_pattern.o -m64 -lcudadevrt -L/usr/local/cuda/lib64  -rdc=true -Xptxas -v
clang++ -o ./bin/direct_cuda_pattern ./obj/_cuda_pattern.o ./obj/direct_cuda_pattern.o ./obj/cuda_pattern.o  -lcudadevrt -lcublas -lcudart -m64 -L/usr/local/cuda/lib64  -lc++ -lc++abi -O3 -pthread
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0

0    0.15736   0

2    0.000395632   -4.2553e-09

4    0.000395632   4.2553e-09

6    0.0552805   -4.93373e-09

8    0.0552805   4.93373e-09

10    0.000395632   -4.2553e-09

12    0.042788   0

14    0.000395632   4.2553e-09

16    0.042788   0

18    -0.00109974   1.61334e-10

20    -0.00109974   -1.61334e-10

22    0.042788   3.82615e-09

24    0.042788   -3.82615e-09

26    -0.00109974   4.79724e-11

28    -0.00109974   -4.79724e-11

30    -0.00109974   1.61334e-10

32    -0.00109974   -1.61334e-10

34    -0.00109974   -4.79724e-11

36    -0.00109974   4.79724e-11

38    0.0552805   -4.93373e-09

40    0.0552805   4.93373e-09
Steepest Descent terminate with total step 2

solution:
(0.50467183722089825615,0.018507226706052093412)	
(0.0082035332872325839038,-0.00045125815669362265813)	
(0.0082035331475790746608,-0.00045108819973769251951)	
(0.031901202808953268986,0.000606001421023257816)	
(0.03190120308937782756,0.00060600708546751965843)	
(0.0058418856411467639383,-0.00041990343484474968025)	
(-0.013573176828235241839,0.00090700552053809679193)	
(0.005841888728051968481,-0.00041977933400911491548)	
(-0.013573176828235241839,0.00090700552053809679193)	
(-0.00063521351922052522211,7.229043840076497609e-06)	
(-0.00063521351977929461571,9.9091749453233878508e-06)	
(-0.02180813707141831051,0.0022300514495265256337)	
(-0.021808137074212162465,0.0022300555582948368948)	
(-0.0011135037758618563774,-1.2972698747120254236e-05)	
(-0.0011135034948785301444,-1.2973075116477216119e-05)	
(-0.0011120103737662259506,1.0829851009266972835e-05)	
(-0.001112009954246929045,1.0829808765823933917e-05)	
(-0.0011114943925814189593,-8.1105132987862323492e-06)	
(-0.0011114943936989577465,-8.1102771417077545448e-06)	
(0.056167319107855384619,0.0007295234851930835606)	
(0.056167319388279943193,0.00072953335265308358413)	

r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0

0    0.15735999999999999988   0

2    0.00039563199999999998238   -4.2553000000000003912e-09

4    0.00039563199999999998238   4.2553000000000003912e-09

6    0.055280500000000003247   -4.9337299999999996707e-09

8    0.055280500000000003247   4.9337299999999996707e-09

10    0.00039563199999999998238   -4.2553000000000003912e-09

12    0.042787999999999999645   0

14    0.00039563199999999998238   4.2553000000000003912e-09

16    0.042787999999999999645   0

18    -0.0010997400000000000925   1.6133400000000000867e-10

20    -0.0010997400000000000925   -1.6133400000000000867e-10

22    0.042787999999999999645   3.8261499999999996552e-09

24    0.042787999999999999645   -3.8261499999999996552e-09

26    -0.0010997400000000000925   4.7972399999999999435e-11

28    -0.0010997400000000000925   -4.7972399999999999435e-11

30    -0.0010997400000000000925   1.6133400000000000867e-10

32    -0.0010997400000000000925   -1.6133400000000000867e-10

34    -0.0010997400000000000925   -4.7972399999999999435e-11

36    -0.0010997400000000000925   4.7972399999999999435e-11

38    0.055280500000000003247   -4.9337299999999996707e-09

40    0.055280500000000003247   4.9337299999999996707e-09
Steepest Descent terminate with total step 2

solution:
(0.50467183722089825615,0.018507226706052093412)	
(0.0082035332872325839038,-0.00045125815669362265813)	
(0.0082035331475790746608,-0.00045108819973769251951)	
(0.031901202808953268986,0.000606001421023257816)	
(0.03190120308937782756,0.00060600708546751965843)	
(0.0058418856411467639383,-0.00041990343484474968025)	
(-0.013573176828235241839,0.00090700552053809679193)	
(0.005841888728051968481,-0.00041977933400911491548)	
(-0.013573176828235241839,0.00090700552053809679193)	
(-0.00063521351922052522211,7.229043840076497609e-06)	
(-0.00063521351977929461571,9.9091749453233878508e-06)	
(-0.02180813707141831051,0.0022300514495265256337)	
(-0.021808137074212162465,0.0022300555582948368948)	
(-0.0011135037758618563774,-1.2972698747120254236e-05)	
(-0.0011135034948785301444,-1.2973075116477216119e-05)	
(-0.0011120103737662259506,1.0829851009266972835e-05)	
(-0.001112009954246929045,1.0829808765823933917e-05)	
(-0.0011114943925814189593,-8.1105132987862323492e-06)	
(-0.0011114943936989577465,-8.1102771417077545448e-06)	
(0.056167319107855384619,0.0007295234851930835606)	
(0.056167319388279943193,0.00072953335265308358413)	


real	0m3.510s
user	0m1.772s
sys	0m1.344s
