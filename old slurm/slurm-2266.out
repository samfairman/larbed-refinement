clang++ -std=c++14 -stdlib=libc++ -O3 -ferror-limit=2 -Weverything -Wno-c++98-compat -Wno-c++98-compat-pedantic -Wno-sign-conversion -Wno-exit-time-destructors -Wno-float-equal -Wno-global-constructors -Wno-missing-declarations -Wno-unused-parameter -Wno-padded -Wno-shadow -Wno-weak-vtables -Wno-missing-prototypes -Wno-unused-variable -ferror-limit=1 -Wno-deprecated -Wno-conversion -Wno-double-promotion -c src/direct_cuda_pattern.cc -o ./obj/direct_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1
nvcc src/cuda_pattern.cu -o ./obj/_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1 -m64 -dc -gencode arch=compute_70,code=sm_70 --relocatable-device-code true  -Xptxas -v
ptxas info    : 9754 bytes gmem
ptxas info    : Compiling entry function '_Z5ZaxpymddP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZaxpymddP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 392 bytes cmem[0]
ptxas info    : Function properties for cudaGetDevice
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5DasummP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z5DasummP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 26 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z8sum_diagP7double2mdd' for 'sm_70'
ptxas info    : Function properties for _Z8sum_diagP7double2mdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 10 registers, 384 bytes cmem[0]
ptxas info    : Compiling entry function '_Z5ZgemmP7double2S0_S0_md' for 'sm_70'
ptxas info    : Function properties for _Z5ZgemmP7double2S0_S0_md
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 40 registers, 8704 bytes smem, 392 bytes cmem[0]
ptxas info    : Function properties for cudaFuncGetAttributes
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z22extract_intensity_diffP7double2PdS1_mm' for 'sm_70'
ptxas info    : Function properties for _Z22extract_intensity_diffP7double2PdS1_mm
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 392 bytes cmem[0], 8 bytes cmem[2]
ptxas info    : Compiling entry function '_Z9compose_aPdPmS_dP7double2m' for 'sm_70'
ptxas info    : Function properties for _Z9compose_aPdPmS_dP7double2m
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 400 bytes cmem[0]
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessor
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5ZscalmdP7double2' for 'sm_70'
ptxas info    : Function properties for _Z5ZscalmdP7double2
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 27 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaMalloc
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm' for 'sm_70'
ptxas info    : Function properties for _Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm
    24 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 72 registers, 448 bytes cmem[0], 104 bytes cmem[2]
ptxas info    : Compiling entry function '_Z5ZcopymP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZcopymP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaDeviceGetAttribute
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z6Dznrm2mP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z6Dznrm2mP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd' for 'sm_70'
ptxas info    : Function properties for _Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 416 bytes cmem[0], 8 bytes cmem[2]
nvcc -dlink ./obj/_cuda_pattern.o -arch=sm_70 -o ./obj/cuda_pattern.o -m64 -lcudadevrt -L/usr/local/cuda/lib64  -rdc=true -Xptxas -v
clang++ -o ./bin/direct_cuda_pattern ./obj/_cuda_pattern.o ./obj/direct_cuda_pattern.o ./obj/cuda_pattern.o  -lcudadevrt -lcublas -lcudart -m64 -L/usr/local/cuda/lib64  -lc++ -lc++abi -O3 -pthread

solution:
(0.8267914676900008919,-0.0037059680629391660543)	
(0.015449832315375137612,-0.012804438067786357708)	
(0.01544983424029764546,-0.012804438576118563897)	
(0.015449828430777105479,-0.012804436822012299144)	
(0.0013915192698353380171,0.024741676107819243757)	
(0.015449830842737172915,-0.012804443894227189246)	
(0.0013915191949716943041,0.024741676306156389076)	
(0.013381739831078612313,0.0024012896903403621596)	
(0.041605297207448571628,0.0051392619602076789961)	
(0.0063638649502420702522,-0.0027063850082515699541)	
(0.0077220468919188319651,-0.0058162142927321892893)	
(0.015996963051787462667,-0.008395416527165909179)	
(0.017825694069840119366,-0.0029442228152485789595)	
(0.013381732031535226168,0.0024012838558328396428)	
(0.0063638663128173893202,-0.0027063874576598004502)	
(0.041605310443322121583,0.0051392868553989268926)	
(0.00028891418275485506459,0.0036534336194629759079)	
(0.006445035045870592047,0.037251903693501717263)	
(0.0074716966949374000531,0.0055325615021278888236)	
(0.041605293720931135759,0.0051392806859717338197)	
(0.0063638653676137716883,-0.0027063858082357009766)	
(0.0021582341106220477404,0.0090873392528206479307)	
(0.018670038809133843172,0.0043037431197731563018)	
(0.0077220491924782867083,-0.0058162131500685979382)	
(0.013770706010335051137,0.0069833097958570669248)	
(0.0063638663760686728713,-0.0027063867662440927765)	
(0.041605313568801975677,0.0051392652234057848229)	
(0.0021582399431522582799,0.0090873425588751163134)	
(0.0046402051061279992947,0.032030303391485076547)	
(0.01177538560952651886,0.0074464017130713745785)	
(0.0077220463865945408732,-0.0058162131652834134568)	
(0.00028891459698835656855,0.0036534343423732388093)	
(0.018670040114956439059,0.0043037362945982267359)	
(0.0046402052835270652179,0.032030303570108310807)	
(0.0111060490854819581,0.0092235003598313373974)	
(0.015996963158781466602,-0.0083954156508140673904)	
(0.0064450360832677064393,0.03725190399980665007)	
(0.0077220462702848298789,-0.0058162149246651171502)	
(0.0099183108573995207996,0.0095891193544181095587)	
(0.01149338869748444715,-0.00085556037421150629273)	
(0.01172353617013583045,0.0044108307550521953788)	
(0.011427825205673178971,0.01243498465748865689)	
(0.0044952700207573758479,0.0095088457577661173598)	
(0.007339728509765898988,0.0093800956228463332892)	
(0.011635740381535619389,0.0087343444844352677303)	
(0.063142536163127011006,-0.0082697768839720218331)	
(0.035705916874982111808,-0.00097511855487482335895)	
(0.0060576493040555012826,-0.0045730020599828221511)	
(0.0039976844229335298242,-0.0076032887841563489423)	
(-0.01301162076164029055,0.0039003547563279893605)	
(0.023718452360644935034,-0.00058162897250267739553)	
(-0.0067165917780781679222,0.00056329471261948576427)	
(0.063142539056319016422,-0.0082697616374401376055)	
(0.0060576491785077277163,-0.0045729988870500930948)	
(0.035705913882035034135,-0.00097511860983963438189)	
(-0.013011620631176071261,0.003900354746291028081)	
(0.0039976852854630212306,-0.0076032896352986323318)	
(0.023718456202396917543,-0.00058162834685148855247)	
(-0.0024909365676252558444,0.020799299173479404712)	
(-0.0067165916238977217342,0.00056329474152070355478)	
(0.035705913215588212795,-0.00097511924563593009325)	
(0.0060576489466307188031,-0.0045729977894833039043)	
(-0.0013495726764919510534,-0.0036505333357265612113)	
(-0.0052286060302333594446,0.0042587105018127768483)	
(0.099649986385825367607,-0.0030075242039441715813)	
(0.0080158360413175328701,0.017318910200418008438)	
(-0.012206890706378493647,-0.0037593344196070119234)	
(0.0060576496941064893187,-0.0045730011623551156119)	
(0.035705911771648279895,-0.00097511775821930587148)	
(-0.0052286062782703583707,0.0042587104289331153412)	
(0.0080158371507667788847,0.017318910420466460121)	
(-0.012206890798356703418,-0.0037593341496946711816)	
(0.003997685235684995779,-0.0076032896189990794786)	
(-0.013011620775722144289,0.0039003552487596173867)	
(-0.0013495728683711549854,-0.0036505327989195847371)	
(-0.0052286061820705368244,0.0042587110146814627365)	
(-0.0044737559285591118122,-0.0060471336728299719676)	
(-0.01301162087193249127,0.0039003551013668132617)	
(0.003997684371540238292,-0.007603289924899413188)	
(-0.0052286061356685261184,0.0042587111719149988234)	
(-0.0044737613967527466857,-0.0060471279675148471161)	
(0.023718454177968913837,-0.00058162362091055319537)	
(0.099649984949210304586,-0.0030075271816902425688)	
(0.0080158352754719341265,0.017318910099593035068)	
(0.011489558323460062964,-0.0055506697220431659712)	
(0.023718456594184176428,-0.00058162712288346472226)	
(0.0080158371466591566562,0.017318910538596757331)	
(0.011489558204173105915,-0.005550669590449916653)	
(-0.0024909375826727723699,0.020799299246222483634)	
(-0.0048531667065203230524,0.0087124329688108813341)	
(-0.0067165914536288237949,0.00056329434279334372315)	
(-0.0067165917681835116473,0.00056329448415406014987)	
(-0.012206890929944229016,-0.003759334428809531746)	
(-0.012206890942914784201,-0.0037593341381246788216)	
(-0.0044737554227599306278,-0.0060471353645832207416)	
(-0.0044737647691133752836,-0.0060471269954653211753)	
(0.011489558425797283259,-0.0055506689135707640986)	
(0.011489558517827741166,-0.0055506691626644420745)	
(-0.0048531671397280254018,0.008712434036310100563)	
(0.0056828319134849883398,-0.0061115847579443867074)	
(0.0056828327509646833077,-0.0061115860562200160708)	
(0.00015075214024637116649,0.0049650236870206511386)	
(0.00015075265787364161302,0.0049650235180495154441)	
(0.0056828321423391123593,-0.0061115848899813219122)	
(0.0051094477009145785815,-0.003247686440117329796)	
(0.0037919254224096777921,0.0022929704294696331111)	
(0.005682832690566979976,-0.0061115856036097638421)	
(0.0037919246997183920708,0.0022929701934136822832)	
(0.0051094482079877502276,-0.0032476868822052828469)	
(0.0051094479316910954014,-0.0032476863271865700003)	
(0.0037919255796976807267,0.0022929702316939436224)	
(0.003791925611694651338,0.0022929706292254894984)	
(0.0051094476457727369678,-0.0032476871556420261467)	
(0.00015075233887950904486,0.0049650236867966757864)	
(0.00015075285875193445394,0.004965023891203893501)	
(-0.0024909373771038762629,0.020799299220889407719)	
(-0.0024909370115147517512,0.020799299549418545641)	
(0.01782569535071462305,-0.002944222689393317851)	
(0.00028891409262237182764,0.0036534338521617320053)	
(0.0064450358364073956005,0.037251903808598989254)	
(0.0074716962404169319154,0.0055325611969437738652)	
(0.013770706174988055909,0.0069833089534455583189)	
(0.0046402053154661251216,0.032030303622178291079)	
(0.01177538523945548081,0.0074464014439088671918)	
(0.00028891393206257969493,0.0036534336915937113202)	
(0.0046402050920130392259,0.032030303443134046371)	
(0.011106049001609863067,0.0092235001721933732033)	
(0.0064450356424251703524,0.037251903940623859457)	
(0.0099183110567397161916,0.0095891192299696666884)	
(0.011493388956715443194,-0.00085556030630734071236)	
(0.011723535835002529132,0.0044108306371826227696)	
(0.011427825094474736156,0.012434984678052742046)	
(0.0044952699523287294181,0.0095088456170894213731)	
(0.0073397285849323623194,0.0093800956345780513168)	
(0.011635740621791405142,0.0087343444116988553511)	
(0.017937970487428667871,-0.0023391562330946007002)	
(0.010304229806614672443,0.010523457107125757867)	
(0.014202249706892097064,0.0068326711953959244975)	
(0.011638625667387107049,0.0089063273117842151061)	
(0.011195971605013071634,-0.001669493731553257183)	
(0.011093214849936239991,0.0095833700583387269878)	
(0.011685366358129056774,0.01202266880290678297)	
(0.0058714737984504970086,0.010021795887222111759)	
(0.011099900466492089099,-0.0066215159750550598231)	
(0.031348713029802431629,-0.012977292309002009391)	
(0.011736038210709509588,0.0092973942252772071027)	
(0.011099897627231175914,-0.006621513929518305086)	
(0.031348715201128862784,-0.012977298346206344801)	
(0.011736036735892187502,0.0092973935529930863686)	
(0.01109989885054993991,-0.0066215137237274858048)	
(0.0039622115808353002009,0.002719204894721611275)	
(0.011099898480415386695,-0.0066215141892787786337)	
(0.0039622116036008431239,0.00271920488583807414)	
(0.0039622115858066880856,0.002719204866295870781)	
(0.0039622115980213609351,0.0027192050269785991885)	
(0.031348713864109443994,-0.012977298004335103415)	
(0.031348713477023872065,-0.012977290450197678448)	
(0.011736037728851135206,0.0092973934153065401764)	
(0.011736037076000651463,0.0092973942909096198017)	
(0.017937971482114071359,-0.0023391574302154467292)	
(0.010304229993735827819,0.01052345702765731042)	
(0.014202249449858603617,0.0068326713189357747222)	
(0.011638625324608358955,0.0089063271496241588898)	
(0.01119597168871611613,-0.0016694936822495487147)	
(0.011093215023045926299,0.0095833698935746686881)	
(0.011685366559354823726,0.01202266881803941076)	
(0.0058714738656893495153,0.010021795661514548009)	
(0.0013915191792042238585,0.024741676290081088263)	
(0.001391519502081958173,0.024741676199958193005)	
(0.017937971673563181396,-0.0023391567999992562976)	
(0.010304229723055616935,0.010523457041364625217)	
(0.014202249625776524472,0.0068326708534771551581)	
(0.0116386254396076156,0.0089063270646062512453)	
(0.011195971733735259057,-0.001669493635040300919)	
(0.011093214714434730672,0.0095833700189856783902)	
(0.011685366527677650689,0.01202266884837849617)	
(0.0058714737605380677363,0.010021795776817599838)	
(0.011723536039748759519,0.0044108304363930407599)	
(0.0044952699740059137712,0.0095088457345537981402)	
(0.0074716963122463380537,0.0055325613253165263974)	
(0.011775385309444042631,0.0074464015096528963361)	
(0.017937970378661460824,-0.0023391571344448325656)	
(0.010304229994499173803,0.010523457053659219379)	
(0.014202249276103784056,0.0068326718143303152159)	
(0.011638625531286157094,0.0089063273103992639246)	
(0.01119597160716245994,-0.001669493631465920544)	
(0.011093215178603087201,0.0095833700187334478621)	
(0.011685366426082352542,0.012022668882051871023)	
(0.0058714736473525668339,0.010021795634733177485)	
(0.011723535660120633708,0.0044108305880066452434)	
(0.0044952698106364950836,0.0095088458313475655859)	
(0.0074716962959975917816,0.005532561528539764982)	
(0.011775385425843706844,0.0074464016245128945848)	
(0.017825695082746426806,-0.0029442233150534461578)	
(0.013770705696077873564,0.0069833094593980552314)	
(0.01110604904232158352,0.0092235002817369678846)	
(0.0099183108950575554763,0.0095891192484179859495)	
(0.011493388935203548498,-0.00085556021376360555895)	
(0.011427825171240812291,0.012434984621471228267)	
(0.0073397284690941300839,0.0093800956375789789482)	
(0.011635740588771623788,0.0087343443904696633356)	
(0.017825694033531840066,-0.0029442221194606677317)	
(0.013770706169010249117,0.0069833093764591260694)	
(0.011106049286549469698,0.0092235003500194760045)	
(0.0099183109610133587952,0.0095891194629041179298)	
(0.011493388677607338511,-0.00085556041767131398544)	
(0.011427824901277774255,0.012434984692942843351)	
(0.007339728524161632725,0.0093800956330655563264)	
(0.01163574049939880041,0.008734344492526295578)	


real	2m19.177s
user	1m37.660s
sys	0m40.396s
