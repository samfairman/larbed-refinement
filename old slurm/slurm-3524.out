clang++ -std=c++14 -stdlib=libc++ -O3 -ferror-limit=2 -Weverything -Wno-c++98-compat -Wno-c++98-compat-pedantic -Wno-sign-conversion -Wno-exit-time-destructors -Wno-float-equal -Wno-global-constructors -Wno-missing-declarations -Wno-unused-parameter -Wno-padded -Wno-shadow -Wno-weak-vtables -Wno-missing-prototypes -Wno-unused-variable -ferror-limit=1 -Wno-deprecated -Wno-conversion -Wno-double-promotion -c src/direct_cuda_pattern.cc -o ./obj/direct_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1
nvcc src/cuda_pattern.cu -o ./obj/_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1 -m64 -dc -gencode arch=compute_70,code=sm_70 --relocatable-device-code true  -Xptxas -v
ptxas info    : 9754 bytes gmem
ptxas info    : Compiling entry function '_Z5ZaxpymddP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZaxpymddP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 392 bytes cmem[0]
ptxas info    : Function properties for cudaGetDevice
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5DasummP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z5DasummP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 26 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z8sum_diagP7double2mdd' for 'sm_70'
ptxas info    : Function properties for _Z8sum_diagP7double2mdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 10 registers, 384 bytes cmem[0]
ptxas info    : Compiling entry function '_Z5ZgemmP7double2S0_S0_md' for 'sm_70'
ptxas info    : Function properties for _Z5ZgemmP7double2S0_S0_md
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 40 registers, 8704 bytes smem, 392 bytes cmem[0]
ptxas info    : Function properties for cudaFuncGetAttributes
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z22extract_intensity_diffP7double2PdS1_mm' for 'sm_70'
ptxas info    : Function properties for _Z22extract_intensity_diffP7double2PdS1_mm
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 392 bytes cmem[0], 8 bytes cmem[2]
ptxas info    : Compiling entry function '_Z9compose_aPdPmS_dP7double2m' for 'sm_70'
ptxas info    : Function properties for _Z9compose_aPdPmS_dP7double2m
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 400 bytes cmem[0]
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessor
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5ZscalmdP7double2' for 'sm_70'
ptxas info    : Function properties for _Z5ZscalmdP7double2
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 27 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaMalloc
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm' for 'sm_70'
ptxas info    : Function properties for _Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm
    24 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 72 registers, 448 bytes cmem[0], 104 bytes cmem[2]
ptxas info    : Compiling entry function '_Z5ZcopymP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZcopymP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaDeviceGetAttribute
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z6Dznrm2mP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z6Dznrm2mP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd' for 'sm_70'
ptxas info    : Function properties for _Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 416 bytes cmem[0], 8 bytes cmem[2]
nvcc -dlink ./obj/_cuda_pattern.o -arch=sm_70 -o ./obj/cuda_pattern.o -m64 -lcudadevrt -L/usr/local/cuda/lib64  -rdc=true -Xptxas -v
clang++ -o ./bin/direct_cuda_pattern ./obj/_cuda_pattern.o ./obj/direct_cuda_pattern.o ./obj/cuda_pattern.o  -lcudadevrt -lcublas -lcudart -m64 -L/usr/local/cuda/lib64  -lc++ -lc++abi -O3 -pthread
Steepest Descent terminate with total step 500

solution:
(0.86409492092462580892,0.00065662515210118503617)	
(-0.01324445578198554796,0.0016015006103725075871)	
(-0.013246526929452670865,0.0015996667950847916467)	
(0.027537442318634208077,-0.00023736846561303750038)	
(0.027541688396085693691,-0.00023768258647785496041)	
(0.010465950969547378052,0.0011013322470344018376)	
(0.022123686505705657951,0.0019889001080057792763)	
(0.022127679649589383076,0.0019863510946710335146)	
(0.015652447967865700668,0.0022594691371542376807)	
(0.015652728053572290134,0.0022637710817546537537)	
(0.010465900827772876489,0.0011013353042644061491)	
(0.022123638546864013432,0.0019887922335259629672)	
(0.022127632758188377909,0.0019862419872030911104)	
(0.015652494168639032729,0.0022593055894840176692)	
(0.01565276998529878047,0.0022636077022096289316)	
(0.043446005103033744077,-0.0011016206418464405663)	
(0.0010622915096477726984,-0.001132426004045126609)	
(0.0010633328021139307803,-0.0011311021112362287105)	
(0.027122714581208160617,-0.0048676692659480871525)	
(0.027125448921920435746,-0.0048655038274309026294)	
(0.043445993241028012244,-0.0011019428649629218857)	
(0.0010622984601128509629,-0.0011322519093292565586)	
(0.0010633405332882805809,-0.0011309306820008260819)	
(0.027122732614219904196,-0.0048679014044478875062)	
(0.02712546387115491453,-0.0048657375187991175683)	
(-0.0038109235577797793103,0.00092770345462434228648)	
(0.01090677536401755271,-0.0047596479594980024147)	
(0.010904115429615921645,-0.0047585389309778248698)	
(-0.0051387705022416319336,0.001000978376233134081)	
(-0.003439415310092109896,0.0043670273645575437629)	
(-0.0034393468055991293156,0.0043672572675285932856)	
(0.0077583982957232814834,-0.0078142765387995884868)	
(0.0077583148362908261816,-0.0078143625008613628452)	
(0.039223102657542141536,0.0014198526946323582372)	
(-0.0051341907864871335135,0.0010019020482537575878)	
(-0.0034364055013084478934,0.0043661093958568967036)	
(-0.0034363408059060267762,0.0043663383262526681006)	
(0.0077580850711409764242,-0.0078125530614682556912)	
(0.0077580007319163262966,-0.007812637802579448093)	
(0.039233465221143515311,0.0014220275939920241567)	
(0.03392617544973016569,0.02233885772407439782)	
(0.021587580872187896869,0.0041822654943495154306)	
(0.021587501506685532332,0.0041823099156377751759)	
(0.018742912304683358865,0.0013991013606598874056)	
(0.01874289447053436794,0.001399008905489269915)	
(0.019412046555914868468,-0.0024382978548879606293)	
(0.033926464395046651568,0.022334259019720220651)	
(0.021586493868352662345,0.0041841348007206199608)	
(0.021586416521671137475,0.0041841783947137054997)	
(0.018742459467356913094,0.001399028501651837118)	
(0.018742440835987195236,0.0013989347577514766978)	
(0.019411297146409579872,-0.002436886498126694927)	
(-0.0038108987740283115607,0.00092790690143895434086)	
(0.010906747656223786738,-0.0047596799336521375401)	
(0.010904086885992829783,-0.0047585696276657022188)	
(0.039233282884749177966,0.001422072517194981206)	
(0.039222922815115711381,0.0014198993032722866982)	
(0.019412077417544214286,-0.002438261265021751667)	
(0.019411332482422563595,-0.0024368495756449276048)	
(0.014903459922831102311,-0.0080809438217393191051)	
(0.014903015448976413698,-0.008079530671819407095)	
(0.001372871122232265876,-0.0040816923191985543529)	
(-0.0035177849832757550168,-0.00085024651544980840972)	
(-0.0035068228003467699118,-0.00086048522966814281962)	
(0.00632976970308832005,0.009546472227446032785)	
(0.0063346481758406805729,0.0095446843933588623038)	
(0.014903475475472426418,-0.008080939193415249619)	
(0.017839573569122340463,0.0013505590497337421722)	
(0.01490302894744175051,-0.0080795249318561419838)	
(0.017838557308077273439,0.0013530614833474920427)	
(0.0013730539382671154251,-0.0040822182122437697394)	
(-0.003517308376539787871,-0.00085124758201442305566)	
(-0.003506350506451241713,-0.00086148637601097036425)	
(0.0063345776994233153612,0.0095446777450513293345)	
(0.006329695161814309981,0.009546465270548485163)	
(0.017839503123080809044,0.0013505012319266573948)	
(0.017838483451026156124,0.001353002599639642695)	
(0.010344434182861126856,0.010323420747696012562)	
(0.010344450300546613464,0.010323018886573625055)	
(0.0096730384853508672577,-0.0037428663014264355359)	
(0.0063270548223236609126,-0.00035596612021380086852)	
(0.0063248507465429627816,-0.00035047712370600027625)	
(0.0065852340723830376373,0.0050026671443387836849)	
(0.0065875938120233366868,0.0050022292654487666638)	
(0.010344428373214479416,0.010323440111675422082)	
(0.014396757487068085127,0.0038314205532052904822)	
(0.010344446607814500316,0.010323038827235841985)	
(0.014396674304581724355,0.0038309084526188781974)	
(0.0096730808564824827256,-0.0037429933854560217162)	
(0.0063272094888961964015,-0.00035590115756969084929)	
(0.0063250026929061800574,-0.00035041147340450620523)	
(0.0065876317055657430261,0.0050020333602666814179)	
(0.0065852708604422858368,0.0050024709809391443294)	
(0.014396685578279680429,0.003831402272076131401)	
(0.014396601783348230222,0.0038308907843353605382)	
(0.0044276539793751774551,0.01506996722538335616)	
(0.013083951946467520591,0.0051186830392289609654)	
(0.013085292942856473555,0.0051197127204135606249)	
(0.012139607300616287247,0.0050820416811228254911)	
(0.0044277286536063406239,0.01506985988843170636)	
(0.013083821053977241766,0.0051187536607620702511)	
(0.013085161388496352811,0.0051197835074542523762)	
(0.012140420230606767046,0.0050798854038897342869)	
(0.012140440205810870689,0.0050799179924973722478)	
(0.012139586461798617528,0.0050820103126095932458)	


real	49m10.752s
user	34m21.504s
sys	14m28.200s
