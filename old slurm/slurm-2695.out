clang++ -std=c++14 -stdlib=libc++ -O3 -ferror-limit=2 -Weverything -Wno-c++98-compat -Wno-c++98-compat-pedantic -Wno-sign-conversion -Wno-exit-time-destructors -Wno-float-equal -Wno-global-constructors -Wno-missing-declarations -Wno-unused-parameter -Wno-padded -Wno-shadow -Wno-weak-vtables -Wno-missing-prototypes -Wno-unused-variable -ferror-limit=1 -Wno-deprecated -Wno-conversion -Wno-double-promotion -c src/direct_cuda_pattern.cc -o ./obj/direct_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1
nvcc src/cuda_pattern.cu -o ./obj/_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1 -m64 -dc -gencode arch=compute_70,code=sm_70 --relocatable-device-code true  -Xptxas -v
ptxas info    : 9754 bytes gmem
ptxas info    : Compiling entry function '_Z5ZaxpymddP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZaxpymddP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 392 bytes cmem[0]
ptxas info    : Function properties for cudaGetDevice
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5DasummP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z5DasummP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 26 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z8sum_diagP7double2mdd' for 'sm_70'
ptxas info    : Function properties for _Z8sum_diagP7double2mdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 10 registers, 384 bytes cmem[0]
ptxas info    : Compiling entry function '_Z5ZgemmP7double2S0_S0_md' for 'sm_70'
ptxas info    : Function properties for _Z5ZgemmP7double2S0_S0_md
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 40 registers, 8704 bytes smem, 392 bytes cmem[0]
ptxas info    : Function properties for cudaFuncGetAttributes
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z22extract_intensity_diffP7double2PdS1_mm' for 'sm_70'
ptxas info    : Function properties for _Z22extract_intensity_diffP7double2PdS1_mm
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 392 bytes cmem[0], 8 bytes cmem[2]
ptxas info    : Compiling entry function '_Z9compose_aPdPmS_dP7double2m' for 'sm_70'
ptxas info    : Function properties for _Z9compose_aPdPmS_dP7double2m
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 400 bytes cmem[0]
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessor
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5ZscalmdP7double2' for 'sm_70'
ptxas info    : Function properties for _Z5ZscalmdP7double2
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 27 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaMalloc
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm' for 'sm_70'
ptxas info    : Function properties for _Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm
    24 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 72 registers, 448 bytes cmem[0], 104 bytes cmem[2]
ptxas info    : Compiling entry function '_Z5ZcopymP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZcopymP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaDeviceGetAttribute
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z6Dznrm2mP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z6Dznrm2mP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd' for 'sm_70'
ptxas info    : Function properties for _Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 416 bytes cmem[0], 8 bytes cmem[2]
nvcc -dlink ./obj/_cuda_pattern.o -arch=sm_70 -o ./obj/cuda_pattern.o -m64 -lcudadevrt -L/usr/local/cuda/lib64  -rdc=true -Xptxas -v
clang++ -o ./bin/direct_cuda_pattern ./obj/_cuda_pattern.o ./obj/direct_cuda_pattern.o ./obj/cuda_pattern.o  -lcudadevrt -lcublas -lcudart -m64 -L/usr/local/cuda/lib64  -lc++ -lc++abi -O3 -pthread
Steepest Descent terminate with total step 1000

solution:
(0.85106104439357144198,0.014772731154526194675)	
(-0.035603997561139591466,-0.0013359238051155709285)	
(-0.035577631482302418675,-0.0013298077202043129784)	
(-0.024861796460746446447,-0.017959755192187724926)	
(-0.024793338302054483691,-0.018005630372778275161)	
(-0.0187961605238944722,-0.015136812918509757325)	
(-0.018923499284356215533,-0.015156418583787566526)	
(0.024266083250476914307,0.01717769855057115283)	
(-0.047813405623463978156,-0.013349222531161292898)	
(-0.0063750052005991540358,7.5422336647208885964e-05)	
(-0.031407006097766081154,-0.022330908998252033126)	
(0.029172258353577090739,0.0050371877298874146583)	
(0.024269883667573297764,0.017173089285740985449)	
(-0.0063810584084552741599,7.5536659301581553488e-05)	
(-0.047914892488746960164,-0.013393586583834195258)	
(0.029169670085720425523,0.0050463044748462193567)	
(-0.031413150310863655057,-0.022329151588035396625)	
(-0.024859847495679258944,-0.017956915214223437977)	
(-0.047806320200996475778,-0.013346960015328639126)	
(-0.0063810001872638844739,7.5020468821935195236e-05)	
(0.010370859741070884846,-0.010775385270148157488)	
(-0.033460369055929403692,-0.004727990810278882676)	
(-0.00073363914016962451098,-0.0013654247149728498695)	
(-0.024796539702420215129,-0.018008698156639912913)	
(-0.00637492461556603187,7.5804673349850305126e-05)	
(-0.047923268705941268752,-0.013396519592897395204)	
(0.010370641619268025635,-0.010774628455120102699)	
(-0.00074209085601775878413,-0.0013585788651910418994)	
(-0.033387154933767086706,-0.0047762646282196452585)	
(-0.018795670305449513338,-0.015134497092017761694)	
(-0.031407967242650172701,-0.022330574143481916188)	
(0.029169681866081115934,0.0050456971024872626294)	
(-0.033459246046702646737,-0.004727015143494773565)	
(-0.00074194041416778629041,-0.0013583815444087681511)	
(0.010008905680822067358,-0.0076405022088180561332)	
(-0.018924459411414257942,-0.015159084677721808981)	
(0.029172386173619765937,0.0050378040056148608999)	
(-0.031412009368063813219,-0.022330035779704691251)	
(-0.00073380051093493482445,-0.0013657197760190767366)	
(-0.033389925975849443773,-0.0047770086119935765978)	
(0.010007759559794876872,-0.0076413170971323480726)	
(-0.020591369245286990364,0.0098332005604911936619)	
(0.053809392001206511613,-0.023663411493655656798)	
(-0.0045042739547830317609,-0.0023601881005205155653)	
(0.036803714137094607761,0.020580101124379728689)	
(-0.03626651884583138169,-0.021306623591644705679)	
(0.0329889106887096481,0.033488321338519158599)	
(-0.020594586252632017531,0.0098296016156388509727)	
(-0.0045023297836632595118,-0.0023609129558598259194)	
(-0.036265663818113726136,-0.021305116491471449286)	
(0.053760872395273100188,-0.023645643603217126466)	
(0.036803569531218757738,0.020578161654417868182)	
(0.032988259477784630247,0.033489835320350387626)	
(0.06136222249825466768,-0.00069574520485511518516)	
(0.061359428462676647575,-0.00069849522888756779369)	
(-0.03390167684571874368,0.032194488242433969005)	
(-0.039163260924530138296,-0.00088405835496884670015)	
(-0.033901395510331333583,0.032194545850710409862)	
(0.05340715676169228987,-0.015447929966656183051)	
(-0.039160992795676162481,-0.00088167029544994801517)	
(0.053406988872976332572,-0.015447965545153459835)	
(0.014390190972088962029,0.025403747581126682326)	
(0.011440802430854069352,0.0093540282649585814595)	
(0.014390288761623985445,0.02540399689501705166)	
(0.011440836965737376588,0.0093542026653962682958)	
(-0.0045315824262791301949,-0.0023266453423642784355)	
(0.053847275418440386507,-0.023422587982998902684)	
(-0.036268422663194445354,-0.0213065484398264407)	
(-0.020594907203105663335,0.0098383311280956092792)	
(-0.033894524790229127453,0.032236297572598320016)	
(0.011444731893617630936,0.009354096975987666665)	
(-0.033894809806320778944,0.032236199645340177233)	
(-0.0045333159115340205744,-0.0023261588578150035368)	
(0.053896247911416658716,-0.023441506467225321775)	
(-0.036269434185714675978,-0.021308090217939598676)	
(-0.020592722204587254192,0.0098419219386204227079)	
(0.01144470251020733749,0.0093539182396052932)	
(-0.039192797601152198905,-0.00085494167351917924307)	
(-0.039195110638141864023,-0.00085727761212109473629)	
(0.036796574812231586105,0.020545695965555482027)	
(0.033007953076649027002,0.033531661990361553982)	
(0.03679686330866593913,0.020547688915477976129)	
(0.03300862249044973773,0.033530395989267720858)	
(-0.019157837498047221997,-0.0028638579523061302549)	
(0.013400375179361087574,-3.199779491141613579e-05)	
(0.049651060463659614508,-0.068808653578463871425)	
(0.041248502245900042773,0.030408999388507978318)	
(-0.019157740524904605384,-0.0028624271072710209124)	
(0.013400635174735362615,-3.1973999516260279174e-05)	
(0.049649538839973389459,-0.068808675206079458753)	
(0.041248510440430187496,0.030408922595365827507)	
(0.0042862036840904376572,-0.044930579689866904924)	
(0.010901587890709855608,0.013637604168018310422)	
(0.0042867456629185922076,-0.044930602447385302456)	
(0.010901669367327287627,0.013637629795030569227)	
(-0.019142851784902131795,-0.0029301944828532618288)	
(-0.01914275771149545613,-0.0029315691410577411971)	
(0.013402587126424137312,-3.5972747749902795472e-05)	
(0.022463335721381233467,-0.010572838868844787116)	
(0.049647665284192309121,-0.068778072929635711286)	
(0.013402214465545299327,-3.6024455050287713161e-05)	
(0.02246336359460357826,-0.010572719451507141958)	
(0.049649237628774829656,-0.068778033316293479826)	
(0.0042845063067851038227,-0.044940851667743378361)	
(0.041251604170745768962,0.030414981774832514777)	
(0.010901633093437243169,0.013637872842142684249)	
(0.0042839876458952890273,-0.044940966527775003114)	
(0.041251629589451353775,0.030415159592824588669)	
(0.010901571235506449936,0.013637845404581549688)	
(-0.0070832915531922916938,-0.0021111871992306324719)	
(0.0073331054318556600918,0.0023359205534865226835)	
(-0.00060278711080694513582,0.0095639512602260258467)	
(-0.0070834404997400261458,-0.0021110066060998941388)	
(0.0073329751670329094623,0.0023362766652202191647)	
(-0.00060273127382094130334,0.0095626009211907496421)	
(-0.0070889371186067919386,-0.0021125972509914566974)	
(0.01344854527990885229,0.01294015428314232441)	
(-0.0070886308140750888679,-0.0021128583925385112548)	
(0.013448619628009339175,0.012940305173864479274)	
(0.013449944231608829473,0.012939830965823967066)	
(0.013449882858691929871,0.012939681708783111816)	
(0.0073353597185491434263,0.0023446295082768303306)	
(-0.00059926275920057885116,0.0095454537946903332546)	
(0.0073354743897302001829,0.0023441729991756365958)	
(-0.00059933457336869928531,0.0095467911857520602187)	
(-0.16557918914418107148,-0.057891309439343570376)	
(0.009847296509909710116,0.0010130465635929551595)	
(0.011678611530778754482,0.009736429751801861654)	
(-0.16557952127131367326,-0.057891351165928653377)	
(0.0098474008842498218785,0.0010128916605615300925)	
(0.011678573177866836963,0.0097364343712343700415)	
(0.0098451812347196583641,0.0010136329281346570085)	
(0.011677582088484215334,0.0097362638049576875204)	
(0.0098450716236822780753,0.0010137839686097369941)	
(0.011677626858590349837,0.0097362631776469529127)	


real	78m56.304s
user	51m2.496s
sys	22m48.448s
