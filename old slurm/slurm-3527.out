clang++ -std=c++14 -stdlib=libc++ -O3 -ferror-limit=2 -Weverything -Wno-c++98-compat -Wno-c++98-compat-pedantic -Wno-sign-conversion -Wno-exit-time-destructors -Wno-float-equal -Wno-global-constructors -Wno-missing-declarations -Wno-unused-parameter -Wno-padded -Wno-shadow -Wno-weak-vtables -Wno-missing-prototypes -Wno-unused-variable -ferror-limit=1 -Wno-deprecated -Wno-conversion -Wno-double-promotion -c src/direct_cuda_pattern.cc -o ./obj/direct_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1
nvcc src/cuda_pattern.cu -o ./obj/_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1 -m64 -dc -gencode arch=compute_70,code=sm_70 --relocatable-device-code true  -Xptxas -v
ptxas info    : 9754 bytes gmem
ptxas info    : Compiling entry function '_Z5ZaxpymddP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZaxpymddP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 392 bytes cmem[0]
ptxas info    : Function properties for cudaGetDevice
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5DasummP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z5DasummP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 26 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z8sum_diagP7double2mdd' for 'sm_70'
ptxas info    : Function properties for _Z8sum_diagP7double2mdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 10 registers, 384 bytes cmem[0]
ptxas info    : Compiling entry function '_Z5ZgemmP7double2S0_S0_md' for 'sm_70'
ptxas info    : Function properties for _Z5ZgemmP7double2S0_S0_md
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 40 registers, 8704 bytes smem, 392 bytes cmem[0]
ptxas info    : Function properties for cudaFuncGetAttributes
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z22extract_intensity_diffP7double2PdS1_mm' for 'sm_70'
ptxas info    : Function properties for _Z22extract_intensity_diffP7double2PdS1_mm
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 392 bytes cmem[0], 8 bytes cmem[2]
ptxas info    : Compiling entry function '_Z9compose_aPdPmS_dP7double2m' for 'sm_70'
ptxas info    : Function properties for _Z9compose_aPdPmS_dP7double2m
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 400 bytes cmem[0]
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessor
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5ZscalmdP7double2' for 'sm_70'
ptxas info    : Function properties for _Z5ZscalmdP7double2
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 27 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaMalloc
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm' for 'sm_70'
ptxas info    : Function properties for _Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm
    24 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 72 registers, 448 bytes cmem[0], 104 bytes cmem[2]
ptxas info    : Compiling entry function '_Z5ZcopymP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZcopymP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaDeviceGetAttribute
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z6Dznrm2mP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z6Dznrm2mP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd' for 'sm_70'
ptxas info    : Function properties for _Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 416 bytes cmem[0], 8 bytes cmem[2]
nvcc -dlink ./obj/_cuda_pattern.o -arch=sm_70 -o ./obj/cuda_pattern.o -m64 -lcudadevrt -L/usr/local/cuda/lib64  -rdc=true -Xptxas -v
clang++ -o ./bin/direct_cuda_pattern ./obj/_cuda_pattern.o ./obj/direct_cuda_pattern.o ./obj/cuda_pattern.o  -lcudadevrt -lcublas -lcudart -m64 -L/usr/local/cuda/lib64  -lc++ -lc++abi -O3 -pthread
Steepest Descent terminate with total step 1000

solution:
(0.80098328769310234154,0.0002794065784880715741)	
(-0.014410900695881606604,-0.00099376231880719421638)	
(-0.014399453415747130725,-0.00099539163949149793431)	
(0.027004921660973950359,-0.0016151527022852298771)	
(0.026995697892902865284,-0.0016201683401086679637)	
(0.013361414269714426417,0.0019021678256596679865)	
(0.022617715064686252924,0.0012937179384935907842)	
(0.022616529592027204837,0.0012842397096525734208)	
(0.011517154087997997711,0.0016240425952632881173)	
(0.011524795759379731844,0.0016253199029486440925)	
(0.013361388831900623125,0.0019028747028663750562)	
(0.022616912041607168532,0.0012939246398877715747)	
(0.022615727668265341033,0.0012844765324115687156)	
(0.011517924389028603299,0.0016233910520598070562)	
(0.011525573045954612406,0.0016246695847506060356)	
(0.042467335349196930205,-0.0019264031552681055905)	
(0.00065778074769916642338,-0.0010408490758705148897)	
(0.00064755596252281206679,-0.0010376154850585959152)	
(0.02503296653535612426,-0.0058904701723453785009)	
(0.025046369874563250563,-0.0059021590768448504993)	
(0.042467324777146819859,-0.0019278324568283633153)	
(0.00065817656730745362648,-0.0010404327167182062571)	
(0.0006479618299617157396,-0.0010371792660156386057)	
(0.025033253516057781679,-0.0058913555092575927222)	
(0.025046667446547533215,-0.0059030385985299757903)	
(-0.0072888780820242003028,0.0001784224997878495274)	
(0.010560380273602518533,-0.0011530858576915071004)	
(0.010559310372032575456,-0.0011611664929457533781)	
(0.010740147517484973511,0.0044791017449591690944)	
(-0.0051249760426461121732,0.01105650436654750414)	
(-0.0051250510589592084346,0.011056388110667827659)	
(-0.0074078839778234017652,-0.011350600277464057558)	
(-0.0074082516848918136473,-0.011350428534872700898)	
(0.044135073759506544822,0.00068703671029310018833)	
(0.01072958938508626961,0.0044845835222950139812)	
(-0.0051300325409772210006,0.011042749538652781374)	
(-0.0051300989370636927364,0.011042631127277852121)	
(-0.0073897355393178539712,-0.011354865626723916264)	
(-0.0073901033421277743246,-0.011354691478570771643)	
(0.044157660585949436161,0.00068570033895449058504)	
(0.045225452834392269874,0.01384045181890913162)	
(-0.0068963106352253914985,0.0066684497075416935413)	
(-0.0068962241100088139678,0.0066696607970398395088)	
(0.015207808707819936087,0.0041206027129277672874)	
(0.015207591181826700735,0.0041208400907103174757)	
(0.026222577292778298519,-0.0013161932008844150124)	
(0.045235577353191697147,0.013804670252294783811)	
(-0.0069127467042733531724,0.0066755433195833206728)	
(-0.0069126725769495037111,0.0066767495471706959573)	
(0.015204531560094488446,0.0041240007111064541645)	
(0.015204314084768508208,0.0041242333339025017205)	
(0.026226061898975569497,-0.001302223654442497729)	
(-0.0072885088810723851552,0.00018017018262270130839)	
(0.010560687375468483587,-0.0011532634735047888382)	
(0.010559617339573302078,-0.001161359071959765666)	
(0.044157951692360711271,0.00068573521824783411835)	
(0.044135362471393942141,0.00068707370559032017975)	
(0.02622243730197705569,-0.001315187046245220974)	
(0.026225924648185128252,-0.0013012188419856273065)	
(0.0097197516485724409774,-0.0044422514593566546359)	
(0.009715210577555470628,-0.004429717628997547306)	
(0.027731718894754713717,-0.0010018483646981231078)	
(0.0082806128623513133163,0.0030879484913443567759)	
(0.0083088860994492540896,0.0030264279476567234294)	
(-0.0077806973586573525623,0.0034239827675907039996)	
(-0.0077818151991732257416,0.0034371801430490840461)	
(0.0097195889916829505267,-0.0044421091084903959953)	
(0.031589767093699976097,-0.0044147792809985089355)	
(0.009715048388638082219,-0.0044295734685711558518)	
(0.031585863884932084689,-0.004422736606082610343)	
(0.027730521000954390376,-0.0010043840057640017818)	
(0.008279231084309786326,0.0030896281609815233297)	
(0.0083075060242053383464,0.0030281123552218314546)	
(-0.0077819329345062762671,0.0034390500555217056421)	
(-0.0077808268333080816276,0.0034258507905281379916)	
(0.031590148884509214322,-0.0044149856693110837297)	
(0.03158624141699939436,-0.0044229480901142228383)	
(0.0095286849823247570662,0.012997290135192490768)	
(0.009527321802187734695,0.01299872468471934342)	
(0.007944629399743913245,-0.0013116173069499031598)	
(0.013959379762651633744,-0.0026985987505618687018)	
(0.013924785390435052632,-0.0025811702699221031505)	
(-0.0078640135559096945722,-0.0060593324917126885343)	
(-0.0078557830839595735317,-0.0060645425653159954274)	
(0.0095288149575915737782,0.012997202331543665152)	
(0.015293103406571991951,0.0018849925928657337675)	
(0.0095274534765296334249,0.012998641194686907235)	
(0.015275631339680200219,0.0018855302456126760927)	
(0.0079476038699536847437,-0.0013122580232731554956)	
(0.013959398579790581463,-0.0027011488200756961567)	
(0.01392481121867755918,-0.002583725452582425787)	
(-0.0078557785264955770632,-0.0060655465311797596845)	
(-0.0078639913172464971647,-0.0060603381945267533956)	
(0.015292850582543652399,0.0018847016149020584357)	
(0.015275374981478349531,0.0018852369809568222687)	
(0.0010711579219652377602,0.0079684724901526275687)	
(0.0073795770345015838931,0.0061956203779326953288)	
(0.007402111568753825567,0.0062132269635859225035)	
(0.018634278160072428182,-0.0014166567747497325457)	
(0.0010689297267667075084,0.0079700938047584830859)	
(0.0073799095012432244789,0.0061960713772119119236)	
(0.0074024429189046203267,0.0062136845463712534962)	
(0.018638668135414294957,-0.0014170574016206620698)	
(0.018638686666496276367,-0.0014173543535001636128)	
(0.018634259860544028636,-0.001416361879622104851)	


real	98m44.632s
user	68m27.928s
sys	29m39.652s
