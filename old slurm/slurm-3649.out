clang++ -std=c++14 -stdlib=libc++ -O3 -ferror-limit=2 -Weverything -Wno-c++98-compat -Wno-c++98-compat-pedantic -Wno-sign-conversion -Wno-exit-time-destructors -Wno-float-equal -Wno-global-constructors -Wno-missing-declarations -Wno-unused-parameter -Wno-padded -Wno-shadow -Wno-weak-vtables -Wno-missing-prototypes -Wno-unused-variable -ferror-limit=1 -Wno-deprecated -Wno-conversion -Wno-double-promotion -c src/direct_cuda_pattern.cc -o ./obj/direct_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1
nvcc src/cuda_pattern.cu -o ./obj/_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1 -m64 -dc -gencode arch=compute_70,code=sm_70 --relocatable-device-code true  -Xptxas -v
ptxas info    : 9754 bytes gmem
ptxas info    : Compiling entry function '_Z5ZaxpymddP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZaxpymddP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 392 bytes cmem[0]
ptxas info    : Function properties for cudaGetDevice
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5DasummP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z5DasummP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 26 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z8sum_diagP7double2mdd' for 'sm_70'
ptxas info    : Function properties for _Z8sum_diagP7double2mdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 10 registers, 384 bytes cmem[0]
ptxas info    : Compiling entry function '_Z5ZgemmP7double2S0_S0_md' for 'sm_70'
ptxas info    : Function properties for _Z5ZgemmP7double2S0_S0_md
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 40 registers, 8704 bytes smem, 392 bytes cmem[0]
ptxas info    : Function properties for cudaFuncGetAttributes
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z22extract_intensity_diffP7double2PdS1_mm' for 'sm_70'
ptxas info    : Function properties for _Z22extract_intensity_diffP7double2PdS1_mm
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 392 bytes cmem[0], 8 bytes cmem[2]
ptxas info    : Compiling entry function '_Z9compose_aPdPmS_dP7double2m' for 'sm_70'
ptxas info    : Function properties for _Z9compose_aPdPmS_dP7double2m
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 400 bytes cmem[0]
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessor
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5ZscalmdP7double2' for 'sm_70'
ptxas info    : Function properties for _Z5ZscalmdP7double2
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 27 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaMalloc
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm' for 'sm_70'
ptxas info    : Function properties for _Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm
    24 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 72 registers, 448 bytes cmem[0], 104 bytes cmem[2]
ptxas info    : Compiling entry function '_Z5ZcopymP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZcopymP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaDeviceGetAttribute
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z6Dznrm2mP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z6Dznrm2mP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd' for 'sm_70'
ptxas info    : Function properties for _Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 416 bytes cmem[0], 8 bytes cmem[2]
nvcc -dlink ./obj/_cuda_pattern.o -arch=sm_70 -o ./obj/cuda_pattern.o -m64 -lcudadevrt -L/usr/local/cuda/lib64  -rdc=true -Xptxas -v
clang++ -o ./bin/direct_cuda_pattern ./obj/_cuda_pattern.o ./obj/direct_cuda_pattern.o ./obj/cuda_pattern.o  -lcudadevrt -lcublas -lcudart -m64 -L/usr/local/cuda/lib64  -lc++ -lc++abi -O3 -pthread
Steepest Descent terminate with total step 1000

solution:
(0.7870987447254446101,0.012135960945851141657)	
(0.0053628475176205423619,0.001141226356662987081)	
(0.0051210791332666734735,0.00094917209460164094544)	
(0.050839759898613244571,-0.015342683607463724477)	
(0.050792576453051366259,-0.015832944832851133382)	
(0.023932785723948284823,0.0019159025004206106917)	
(-0.01004303183043345378,0.0037867776140430697146)	
(-0.010007437162140890227,0.0037998443527539286363)	
(-0.0085244788492179028594,-0.024890159955841213713)	
(-0.0086151595927972963312,-0.024890509019721625272)	
(0.022337275026674430212,0.0026137693313026907384)	
(-0.011616863302864703644,0.0040280701988850697859)	
(-0.011579867989345070042,0.0040861706816627020589)	
(-0.006465721648816194142,-0.022910099037938239097)	
(-0.0065397770216707911198,-0.022885011809837037949)	
(-0.0022008356145176996913,-0.0056328170080941677295)	
(0.018139444851920261126,0.0033709860289106463073)	
(0.018089290431876604848,0.0032553536364887209961)	
(0.030318572951938415477,-0.0035870796078155682378)	
(0.030412269961477646218,-0.003798066063393825461)	
(-0.0023549620606547550308,-0.0080812780544891778256)	
(0.017935745103532806793,0.0021443711753839967728)	
(0.017877409197560430176,0.0018675677797768018215)	
(0.029735424324616965136,0.00024894692435600200391)	
(0.029768643347987514686,-1.9622837554571436424e-05)	
(0.0049869027000224476487,-0.012981464166287051687)	
(0.018755174070940041492,0.0038831850607107436593)	
(0.018924444652205881651,0.0040962087276066663777)	
(-0.0088338637561695722289,0.019318768308645914433)	
(0.041256273593494041663,0.0080568256528047391823)	
(0.040678267618060204303,0.0097976940977101932562)	
(0.019296976311394421072,0.029326082775696676874)	
(0.017351906086357039849,0.029972917000453843522)	
(-0.019132742445416316135,-0.0034891389843856751053)	
(-0.008959008393550623589,0.019298860113889242801)	
(0.041170490471238094243,0.0077291841698865519292)	
(0.040575103191973611871,0.009468371263728979359)	
(0.019389320989199109596,0.02927623487865008145)	
(0.017466678043456598801,0.029956650676544453737)	
(-0.019056497200776921497,-0.0032282150863664556446)	
(0.031948273765574727867,0.01892211094062650617)	
(-0.01878965312275550012,0.0026720373058969145059)	
(-0.017024903898275722119,0.00027809628946068136457)	
(-0.013476480027363096914,-0.032481512034642542885)	
(-0.01356954139820935358,-0.034137852765735769711)	
(0.066138292449767391301,-0.016151800190089563025)	
(0.031833065902428951677,0.019384364566260713081)	
(-0.018630474825734294475,0.0026963900642613916787)	
(-0.016880791815686732593,0.00030000117177825610547)	
(-0.013683445507842489225,-0.032409756256190906665)	
(-0.013737097096549867256,-0.034051956895108891066)	
(0.066148354846284396213,-0.016172303243216216984)	
(0.0024917172722665830407,-0.013729725195558791298)	
(0.018064094159952213958,0.0062774463580316398198)	
(0.018288772399655844891,0.0064750747534641902789)	
(-0.019364839825529365364,-0.0075630206448288736162)	
(-0.019387971945064867013,-0.0078086442634605632632)	
(0.066719865155394145195,-0.018523793329947583347)	
(0.06677056165793397724,-0.018564182150739894778)	
(0.065584139941643693206,0.038578144771967630422)	
(0.065611889647319995844,0.038627532634343798856)	
(0.024897748146942819819,0.012839836224713577911)	
(0.036308140579327345676,2.4870459645709993375e-05)	
(0.036530217169463315152,0.00021805776252449291853)	
(-0.013799386083572990833,0.018523608465248281307)	
(-0.013871191860648510522,0.018420505434791779181)	
(0.065076604511859328928,0.039450638314014879748)	
(0.047008679894128782562,0.0061060394905284769498)	
(0.065100399469465178304,0.03946578884710935653)	
(0.046961767705479336155,0.0059883612139179755521)	
(0.031867062176667113049,0.012056836931704575933)	
(0.036912621312244930927,-0.00012229052307094175414)	
(0.037187689344193058938,6.0527943598306985348e-05)	
(-0.014622564258774997312,0.019650472903844664468)	
(-0.014541433864333085449,0.019809661051694855971)	
(0.046399390539184029447,0.0065340515292223524946)	
(0.046356458376930399778,0.0064332581371984651208)	
(0.014693176672124370549,0.019964069574774347127)	
(0.014679314591416858793,0.020016632089167703951)	
(0.075673163854393502015,0.060759213569129999488)	
(-0.017807255520057335002,-0.0010990993965908856488)	
(-0.017482550899024687507,-0.0011551122723097956117)	
(0.023761755333549523794,0.019459305577176393143)	
(0.023619630668744801688,0.019466075295047544774)	
(0.014844879768520431382,0.019363722405553899369)	
(-0.014763634678474512121,-0.01264936753618023553)	
(0.014843637015814979338,0.019414293650973562383)	
(-0.014701855535359818761,-0.012676763862224989937)	
(0.075434343132742873173,0.063065508773522932495)	
(-0.019555912951320850168,-0.0024327680666032208516)	
(-0.019199935036493958468,-0.0025342055619871611122)	
(0.023410148181362201714,0.018600269310504822379)	
(0.023548347709308671549,0.018544261150951497213)	
(-0.01523655313485510962,-0.01216010812813825108)	
(-0.015148765052888375771,-0.012191856150584982899)	
(0.07565777410835203276,-0.038101840165056743981)	
(-0.038216505740957425197,-0.026128622857315542127)	
(-0.038386405148668548137,-0.026102410108076682521)	
(0.00063771676238763921624,-0.011076077744428269173)	
(0.080474236210405475367,-0.039845831611518965631)	
(-0.037673283447729452589,-0.029904660449917134374)	
(-0.037828567788452463483,-0.029877020221744390871)	
(0.0031947046349170673055,-0.010146092527988636103)	
(0.00065554129110712271861,-0.011038763826239566396)	
(0.0031628002482506018325,-0.010169119589802814996)	


real	96m24.743s
user	65m5.512s
sys	28m7.816s
