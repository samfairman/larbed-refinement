clang++ -std=c++14 -stdlib=libc++ -O3 -ferror-limit=2 -Weverything -Wno-c++98-compat -Wno-c++98-compat-pedantic -Wno-sign-conversion -Wno-exit-time-destructors -Wno-float-equal -Wno-global-constructors -Wno-missing-declarations -Wno-unused-parameter -Wno-padded -Wno-shadow -Wno-weak-vtables -Wno-missing-prototypes -Wno-unused-variable -ferror-limit=1 -Wno-deprecated -Wno-conversion -Wno-double-promotion -c src/direct_cuda_pattern.cc -o ./obj/direct_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1
nvcc src/cuda_pattern.cu -o ./obj/_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1 -m64 -dc -gencode arch=compute_70,code=sm_70 --relocatable-device-code true  -Xptxas -v
ptxas info    : 9754 bytes gmem
ptxas info    : Compiling entry function '_Z5ZaxpymddP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZaxpymddP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 392 bytes cmem[0]
ptxas info    : Function properties for cudaGetDevice
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5DasummP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z5DasummP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 26 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z8sum_diagP7double2mdd' for 'sm_70'
ptxas info    : Function properties for _Z8sum_diagP7double2mdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 10 registers, 384 bytes cmem[0]
ptxas info    : Compiling entry function '_Z5ZgemmP7double2S0_S0_md' for 'sm_70'
ptxas info    : Function properties for _Z5ZgemmP7double2S0_S0_md
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 40 registers, 8704 bytes smem, 392 bytes cmem[0]
ptxas info    : Function properties for cudaFuncGetAttributes
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z22extract_intensity_diffP7double2PdS1_mm' for 'sm_70'
ptxas info    : Function properties for _Z22extract_intensity_diffP7double2PdS1_mm
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 392 bytes cmem[0], 8 bytes cmem[2]
ptxas info    : Compiling entry function '_Z9compose_aPdPmS_dP7double2m' for 'sm_70'
ptxas info    : Function properties for _Z9compose_aPdPmS_dP7double2m
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 400 bytes cmem[0]
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessor
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5ZscalmdP7double2' for 'sm_70'
ptxas info    : Function properties for _Z5ZscalmdP7double2
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 27 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaMalloc
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm' for 'sm_70'
ptxas info    : Function properties for _Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm
    24 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 72 registers, 448 bytes cmem[0], 104 bytes cmem[2]
ptxas info    : Compiling entry function '_Z5ZcopymP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZcopymP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaDeviceGetAttribute
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z6Dznrm2mP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z6Dznrm2mP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd' for 'sm_70'
ptxas info    : Function properties for _Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 416 bytes cmem[0], 8 bytes cmem[2]
nvcc -dlink ./obj/_cuda_pattern.o -arch=sm_70 -o ./obj/cuda_pattern.o -m64 -lcudadevrt -L/usr/local/cuda/lib64  -rdc=true -Xptxas -v
clang++ -o ./bin/direct_cuda_pattern ./obj/_cuda_pattern.o ./obj/direct_cuda_pattern.o ./obj/cuda_pattern.o  -lcudadevrt -lcublas -lcudart -m64 -L/usr/local/cuda/lib64  -lc++ -lc++abi -O3 -pthread
Steepest Descent terminate with total step 200

solution:
(0.94266673902473641089,0.025585811970544037469)	
(0.0052274025903452378886,-0.0013421322846798094605)	
(0.0052231790121007870553,-0.0013351312946003461059)	
(0.0054817545037540516342,-0.0019099478026223871193)	
(0.0054803407327248523581,-0.0019058834500092324948)	
(0.0064470728414507405546,-0.0016345824435880236102)	
(0.0095007248613948984406,0.0012880604299844546686)	
(0.0066265602254768915871,-0.0019273467286543641969)	
(0.0094248711304057621735,0.0011689692607965123782)	
(-0.0040884468154917825294,0.021660262887921340191)	
(0.0080099376961542453207,-0.0059749086841534718509)	
(-0.0040909868199062509805,0.021662614280627167512)	
(0.0080730291269719249569,-0.0059387142069927834759)	
(-0.01087280134553236105,-0.024944839627774193641)	
(0.016542924615078027223,0.00089212737608565712867)	
(-0.010874901582050343005,-0.024944365287961487582)	
(0.016519053473840427521,0.00083204009408177571818)	
(0.0064537038101438563842,-0.0016388208996089574567)	
(0.0066277352394904657032,-0.0019326066865896543955)	
(0.0095073325662181403656,0.0012819718336774964165)	
(0.0094259915997236855267,0.001170880876938938794)	
(0.00807828495468568622,-0.0059339377206282127239)	
(0.016515841781907136115,0.0008347637574029869844)	
(0.0080145140541746061336,-0.0059697670205753070385)	
(0.016537559613286866023,0.00089889663434429166108)	
(0.012259192428608473718,7.2038195446375952007e-05)	
(0.02421847553165900821,-0.0022969489306688202664)	
(0.01364906175286538341,0.0024506874604567495564)	
(0.017770724147366554618,0.00053484577507099072529)	
(0.012272013276722268382,6.2657812913244904083e-05)	
(0.024233413565706608817,-0.0022981126386805135822)	
(0.017758345866661286172,0.0005105823412483920503)	
(0.022133784617244165599,0.0038045081815918720299)	
(-0.0080737764436560471859,0.0077799408068114665402)	
(0.013644837443806444657,0.0024484307598264796503)	
(0.022128347291148459108,0.0038041476037436010305)	
(-0.008069318540383906696,0.0077778454795322353454)	
(0.012351228055367880973,-6.8880288629492408521e-06)	
(0.012341932025636570894,-2.6361051643577212229e-06)	
(0.024123039663781382924,-0.0024417086662410210189)	
(0.01793092199219953331,0.00059794450391692467381)	
(0.024137449135976294518,-0.0024435445841248489354)	
(0.01792157494678385185,0.00058449265461623278912)	
(0.022174227922424471354,0.0039568299314897388899)	
(-0.0080722194069870294164,0.0078381833993044387754)	
(0.022170003032564031958,0.0039569941990861634898)	
(-0.0080674329181640441755,0.0078410653017390394975)	
(0.022634709484795005607,-0.001093036019242253111)	
(0.022565801167602553279,-0.0011477141998945982523)	
(0.022583508181406350412,-0.0011553948768663359608)	
(0.022656753643427784972,-0.0010998790779473987568)	
(-0.011750268437773967595,0.0073245448280898238155)	
(-0.0018809287015137702778,0.025208248980299545472)	
(-0.011774834324614520675,0.0073156606482009840786)	
(-0.0018946241157135066194,0.025220917738324955676)	
(-0.0017798728884391714581,0.025050183250721166223)	
(-0.011792326888746307995,0.0072824118260918103279)	
(-0.0017872118995286099402,0.025063976507325929494)	
(-0.011816778330361975627,0.0072721147421717308515)	
(-0.0092004519095747056001,-0.0094545412719794566514)	
(-0.009320994261399333583,-0.0094230294003151676002)	


real	9m18.499s
user	6m31.956s
sys	2m39.404s
