clang++ -std=c++14 -stdlib=libc++ -O3 -ferror-limit=2 -Weverything -Wno-c++98-compat -Wno-c++98-compat-pedantic -Wno-sign-conversion -Wno-exit-time-destructors -Wno-float-equal -Wno-global-constructors -Wno-missing-declarations -Wno-unused-parameter -Wno-padded -Wno-shadow -Wno-weak-vtables -Wno-missing-prototypes -Wno-unused-variable -ferror-limit=1 -Wno-deprecated -Wno-conversion -Wno-double-promotion -c src/direct_cuda_pattern.cc -o ./obj/direct_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1
nvcc src/cuda_pattern.cu -o ./obj/_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1 -m64 -dc -gencode arch=compute_70,code=sm_70 --relocatable-device-code true  -Xptxas -v
ptxas info    : 9754 bytes gmem
ptxas info    : Compiling entry function '_Z5ZaxpymddP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZaxpymddP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 392 bytes cmem[0]
ptxas info    : Function properties for cudaGetDevice
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5DasummP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z5DasummP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 26 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z8sum_diagP7double2mdd' for 'sm_70'
ptxas info    : Function properties for _Z8sum_diagP7double2mdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 10 registers, 384 bytes cmem[0]
ptxas info    : Compiling entry function '_Z5ZgemmP7double2S0_S0_md' for 'sm_70'
ptxas info    : Function properties for _Z5ZgemmP7double2S0_S0_md
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 40 registers, 8704 bytes smem, 392 bytes cmem[0]
ptxas info    : Function properties for cudaFuncGetAttributes
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z22extract_intensity_diffP7double2PdS1_mm' for 'sm_70'
ptxas info    : Function properties for _Z22extract_intensity_diffP7double2PdS1_mm
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 392 bytes cmem[0], 8 bytes cmem[2]
ptxas info    : Compiling entry function '_Z9compose_aPdPmS_dP7double2m' for 'sm_70'
ptxas info    : Function properties for _Z9compose_aPdPmS_dP7double2m
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 400 bytes cmem[0]
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessor
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5ZscalmdP7double2' for 'sm_70'
ptxas info    : Function properties for _Z5ZscalmdP7double2
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 27 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaMalloc
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm' for 'sm_70'
ptxas info    : Function properties for _Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm
    24 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 72 registers, 448 bytes cmem[0], 104 bytes cmem[2]
ptxas info    : Compiling entry function '_Z5ZcopymP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZcopymP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaDeviceGetAttribute
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z6Dznrm2mP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z6Dznrm2mP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd' for 'sm_70'
ptxas info    : Function properties for _Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 416 bytes cmem[0], 8 bytes cmem[2]
nvcc -dlink ./obj/_cuda_pattern.o -arch=sm_70 -o ./obj/cuda_pattern.o -m64 -lcudadevrt -L/usr/local/cuda/lib64  -rdc=true -Xptxas -v
clang++ -o ./bin/direct_cuda_pattern ./obj/_cuda_pattern.o ./obj/direct_cuda_pattern.o ./obj/cuda_pattern.o  -lcudadevrt -lcublas -lcudart -m64 -L/usr/local/cuda/lib64  -lc++ -lc++abi -O3 -pthread
Steepest Descent terminate with total step 1000

solution:
(1.0017502897000611917,-0.00037853373133710254729)	
(-5.9778434790363769633e-05,0.00021666991212584732723)	
(-0.0011392064231187722535,0.00060263389033252362341)	
(0.019427782776487077104,-0.00046337063548227726403)	
(0.019025711361998699084,0.00036241526705511195724)	
(0.020867390345141970109,-0.00024953412355376394013)	
(0.019774893030798677829,-0.00014453858075816913929)	
(0.064383672586780529845,-0.00046182886290839725383)	
(-0.0020821319528544807338,-0.0006859781861309261668)	
(-9.0578699177200865919e-06,-0.00054459575846056772035)	
(-0.00078655096025357609975,-0.0003804666615310042777)	
(-0.00061239488656665000063,-0.00077473108053950601962)	
(0.064774762489361425999,0.00057286536177823886139)	
(-0.00062581014795422230598,0.0001445337673917216671)	
(-0.00068051186083788661393,-0.0013968382441483023423)	
(-0.0011311312085537385784,2.7052960539916287325e-05)	
(-0.00037027281696249488181,-0.00079043392541842342341)	
(0.019797032006398145032,-9.5984213615237282645e-05)	
(-0.0013501209740308546797,-0.00060529194476470113938)	
(-0.00039560367896628072714,-0.00084845185551405625634)	
(0.010145546912187745556,-0.00023046419050177523766)	
(0.049904589025973465632,0.00026016321396255312872)	
(0.0045372009510611351416,-0.0001823704542288914559)	
(0.019718556643294141845,-0.00022781463029044986203)	
(-0.00086811967382022323797,0.00020440982822993072465)	
(-0.00089811037210956400599,0.0005164802023175179245)	
(0.010483259155725481102,0.00062662067737266733021)	
(0.0043217777587274703449,-0.00058270207340974458383)	
(0.050374230494049862528,0.0003080521979250456675)	
(0.020434346203287153537,-0.00021825669414345536738)	
(-0.00097002995782788478847,-0.0014652700021428152928)	
(-0.00080825787725743341357,-0.00056731494363154819516)	
(0.050204818522371491563,-0.00015690716937997819017)	
(0.0040912204999709348915,-0.00059404710143356239532)	
(0.0066773054852012868332,0.00079935923165536722657)	
(0.020900804682017302266,-0.00075537907618702156837)	
(-0.001196714149421139288,0.00049491214806669109067)	
(-0.00014939922354536956336,-0.00045828429833501992856)	
(0.0036620272637889889067,-8.9783904930823381363e-05)	
(0.05007941183031344029,-0.00067900889784086257157)	
(0.0067787513363288731325,0.00065112923641700421167)	
(-0.00036407863920797679802,0.0016418065075158828296)	
(0.012205714395775014644,0.00040827918049465047445)	
(0.0062789679050819380973,4.6949425727912728445e-05)	
(0.0016442030197539882728,0.00034440924808325657641)	
(0.00066431278956370252379,-0.0011605149451619288341)	
(-0.0004745553729797992123,-0.00030724345024170455478)	
(0.006865267041812085462,0.00037420674724000747499)	
(0.0080997769746956622267,0.00072453243010679908853)	
(0.01193531097414894486,0.00017685959479961453188)	
(0.00099624917691217658097,0.0016741081196464037851)	
(-0.00030807292888027255906,0.0011672058120422521693)	
(0.0090219144309679442928,-1.1701547578337497855e-05)	
(0.042878196446979183198,-6.5717978933708747716e-05)	
(0.001096721211720040742,0.0004737750670433972652)	
(0.00079337674713165541335,-0.00038088444440439306717)	
(0.0062169034891788443192,0.00047641638453796685817)	
(0.0088647954427109269121,-0.00052273934393661934845)	
(-0.0011447476526011486804,0.00085981638453761356604)	
(-2.4355205097290265847e-05,-0.0021777924538912002417)	
(0.0085018767079991681979,0.00015227601038539012915)	
(0.043049176025844779203,0.00032492129390909041268)	
(-0.00087689390250606685014,0.0019020548264069396527)	
(0.00067460898647620241766,0.00078135665328490000372)	
(0.003269060176686936197,0.00193584728448710627)	
(0.012064764197352891364,0.0016639169170153647777)	
(-6.2273443650121290563e-06,-0.00081818953777022741976)	
(0.0078778421118549102342,1.2037625333405259576e-05)	
(0.0011547189304286678124,0.000521876159972339956)	
(-0.0014966383085612963103,0.00011421380298239411756)	
(-0.0010590911997213358926,0.0021554916757082465649)	
(0.0064153613226865212338,0.0090856356432370780768)	
(-0.0011358625906858011226,0.0023327588594536700049)	
(0.0064499107104078129762,0.00043230295908363626251)	
(-0.00016345292089864991839,-0.00049669790301682184563)	
(0.0127454553103918556,0.00034673362365904308478)	
(-0.00015522095287724552702,-0.0011086785383374857944)	
(-0.00028175269717290189666,-0.0023188983146458074652)	
(0.00084478783038238985763,-0.0012435848392694994358)	
(0.0066695065205050274929,0.0096031374647003332062)	
(0.0098201979911266400886,0.009525277285468291763)	
(0.0016796622304338679026,0.00052525305637394798398)	
(0.0062374261647506965001,0.00070776488164767451233)	
(0.00068883154456013645072,0.0017445701531463937619)	
(0.0057089967763620944399,0.0012148188111492928039)	
(0.0080919735791390463159,-0.0003105657948544597092)	
(0.003208466732742781477,0.0018667736178168113387)	
(-0.00010109288413151951581,0.0026429146007569230548)	
(0.0097789149963086064582,0.0095057811233427158548)	
(0.0019858187579844610929,-0.00096765094290437233138)	
(0.025447550935056587051,1.6520305893557338494e-05)	
(0.0022562590717294665928,-0.00092179729204079706006)	
(0.024900534266936776712,0.00082312559189670197069)	
(0.0074571643922102699709,3.0312042040327833608e-05)	
(0.0032064363345262617347,0.00088514328221289716777)	
(0.0072573119213237254413,-0.0016458087088981518918)	
(-0.00019016197281902832007,-0.0013982618537088174326)	
(-0.00029701536154619790232,-0.00030969246103855013969)	
(-0.0035163139530397574326,0.0012332201785936586745)	
(0.01288256895296760289,0.0011560868245686136552)	
(0.0066246232267281063982,-0.00029699983754240348024)	
(0.0020545216416386164957,-7.4082695234772759992e-05)	
(-0.00066402099414699722931,0.0003896745682217813778)	
(-0.0030992339665291933348,0.00050409446999047011467)	
(-0.00036817306982925757011,0.00031245460216048454808)	
(-0.0006070673316574493137,0.0018943666058953082931)	
(-0.0013791038566775433698,-0.00095194343774544917195)	
(0.0072403902300601846384,0.00072404893302078349431)	
(-0.00022514625749363965327,-0.00040778532131216169154)	
(0.012016161296088428978,0.00039879598011983909567)	
(-0.00068366748098297328365,1.1003678015427220305e-06)	
(-0.00018267685661534072399,0.0012114890487950134412)	
(0.064471717181200718927,-7.8589162923031568014e-05)	
(0.0018815843881025903772,-0.00016768815704476861244)	
(-5.2782112061081263806e-05,-0.00056612758664959352342)	
(0.0076168423538766159148,0.00010003619764015169705)	
(-0.0032341274510257838302,0.00014534505958523774322)	
(0.064735334748631814805,0.00039648259067508450368)	
(0.0039160573936765424516,0.00073644418230723273072)	
(0.0068572834597011300684,-0.00091786454427407774496)	
(-0.0036502592139365025101,0.0011439718492594751643)	
(0.0024523912649438723427,-0.00029136325186427796405)	
(-0.00056671909256047320845,0.00071650893004200416278)	
(-0.0017530875082105922772,-0.00025511103830523184765)	
(0.0037342782994655016049,0.00086880042942015923806)	
(0.012559745617199006076,0.00047163590876042805382)	
(-0.00028944867255733755127,0.0001519915653316786892)	
(-0.00048359121299381720291,0.00015231781021253422859)	
(0.0026095519729959293712,8.4432494376582918789e-05)	
(-0.00065903089031759916946,5.5357694367258886972e-05)	
(0.0012581307983314221188,-0.00040698262720714902495)	
(0.007399985651856500618,-0.0020322426714875102029)	
(0.020740174076988474733,-0.00016111638098690667575)	
(0.0019938424819343496426,-0.0022714668906125669648)	
(0.0043810172052220763828,0.0010698061089838891563)	
(0.018916102486365746899,-0.00022684268238461647183)	
(-0.00083492192565098215847,0.00058604505663580042357)	
(0.0019276070221239290092,-0.0019218473045288218294)	
(-0.0004665376231144803109,-0.0018157675522085798929)	
(0.019051376501244245837,0.0004609481605660144558)	
(0.01201547553176354928,-1.2528605526590917848e-05)	
(-0.00058435482595185783434,-0.00067975716700543272093)	
(-2.8231691349322535011e-05,-0.00046951367530878438577)	
(0.0091447431203666041527,0.0074501757489678207755)	
(0.00076028550254079508598,-0.00043980065882986106585)	
(0.0062865860575415681219,-0.0016091770730365623047)	
(0.0042468093866431487482,0.0010184320218999830168)	
(0.0092916773514621509716,0.0071211170867098560339)	
(0.0063524761512388540352,0.0093235739238444140936)	
(0.00020152828100711286875,0.00021803654870883152923)	
(0.0037584032099327799314,-0.00044559643551306358112)	
(0.01992906486191138235,-0.00016638271327628346269)	
(0.019701452989870592986,-0.0010392477395455229985)	
(-0.00054478243836126184329,-0.0019469832121659013877)	
(-5.20807785887167425e-05,-0.0012764338227272159932)	
(0.0064379951469928390836,0.0092575957960315553158)	
(0.019151301550597493728,-0.00048629567717293218157)	
(-0.0011907940597749504079,-0.00050829270415350257407)	
(0.0069889524111959658303,-0.00040521289415206912738)	
(4.3452576728042252487e-05,0.00014917605039415954456)	
(0.0066238132939415482817,-0.00095817291499830170923)	
(-0.0027245481051328323749,0.00068290852786424534413)	
(-0.00045428168077415315151,0.00051299687551121023448)	
(0.00029503460152224001214,-0.00074203379306685308958)	
(0.0070515496315559263174,-0.0024722797711409995498)	
(0.0078047063057809194786,-1.4592717695585948152e-05)	
(-0.0030085854499849349827,0.00072825487373728327312)	
(0.0057290005747038796891,0.00060950034971440382719)	
(0.0010991527676187883532,3.2232104885834574721e-05)	
(0.00077469690310011916651,0.0013418912703672661226)	
(0.0090589366029974541239,-0.00026039126274095584449)	
(0.0021193370042959531335,-0.0012127382583512749323)	
(0.0065308320696360255483,0.00066184199848822572974)	
(0.0010083192256093401629,2.2308257160793348807e-05)	
(0.00055153633957029629242,0.0013347434497664538953)	
(0.0080331428878505379415,-0.00069327108367945168392)	
(0.0017450590783811043179,-0.00061664188916075340138)	
(0.0029474505393127727222,0.0014012380592392896517)	
(0.0035011846750342603268,0.0016179623289130072063)	
(0.0065341935752330649462,-0.0013471071735632418522)	
(-0.0037470889990627695605,0.00063353495934337215358)	
(-0.00043368450852307818301,0.00063466607389751450267)	
(-6.1135431111924455876e-05,-0.00078093311411306278857)	
(0.020331455719106553831,-0.00031639039970779848747)	
(-0.00076152052454655963076,0.00017207433659037198138)	
(-0.00076436461192453449692,0.0007978701526125332906)	
(0.00079999707672855178021,-9.1471411215018341104e-05)	
(0.020102645468080847235,-8.7507825535588688003e-05)	
(0.0060410843528154681975,-0.0018618523654774551523)	
(-0.0034884762050625167835,0.0009239947952268521723)	
(-0.00057441346053333397926,0.00024254900435176802173)	
(0.0020315980662969405045,-0.00063639384581712485269)	
(0.001468481592415138209,-0.0013159139021533558609)	
(0.0066985145420523015125,-9.7516411804744472015e-05)	
(0.0086726852515691624929,-0.00052246217772481621383)	
(0.042922898948164076027,-0.00049377860123356819531)	
(0.00034643182100248747467,0.00013415808852886300416)	
(0.0055509171174503218679,0.00091989830889840332358)	
(0.0090627179727921641783,-0.0004454010450675645349)	
(0.043238239269788827923,0.00033907674753774850324)	
(0.00056684704481232300356,-0.0001167062542579859393)	
(0.0064580960583252777427,-8.5031608047169370251e-05)	
(0.0097905157135154356057,0.0094735362052407023209)	
(0.0054141580968113381042,0.00085133771113150944355)	
(0.0097793582424634348943,0.0094938054869723315088)	
(0.025420667706856806684,-0.00031519309844330793777)	
(0.0095685379907996959831,-3.7431247477954756242e-05)	
(0.0092407296158186838508,0.00082529896886007086433)	
(0.025626802546660006066,-0.00019190576145748254383)	
(0.0094432713977415979473,0.00076653170668461738293)	
(0.0094260963034157475154,0.00049655146182939527942)	
(0.010195907071513059944,0.00051583644357547516444)	
(0.0091696326271777789385,0.00035405405296057003385)	
(-0.00043207754887331079182,0.00023254301421016550081)	
(-0.00060105856440241588017,-0.00010129054736458233067)	
(0.00080295422989837392149,0.001552649294437325779)	
(-0.00031514654507286990427,0.00058199118901431637005)	
(0.00051726254496747999228,0.0011513902338540335426)	
(-0.00012901032053282357687,-0.00057655122081763665338)	
(0.00021100983252271473265,0.00059239767557074576171)	
(0.011048504569405537268,-0.00043202265598138878816)	
(-0.00037361249762571185039,0.000351154759054156287)	
(0.011444869265589964827,0.00068637934988005383941)	
(-0.0029061633094927840672,0.000633412589596541592)	
(-0.0028091334870030282983,0.00073088305580868697872)	
(-0.0008769111003555206266,0.00010792319657824312091)	
(-0.0012005128050579546954,7.2344556148395576176e-05)	
(0.00049995074581435003901,0.0011215750881656827431)	
(0.0004295527469876228902,0.00097504715028338376399)	
(0.0088965046381075541665,0.00039191942042012450822)	
(0.009321562928241891588,-0.0012095808911037047445)	
(-0.00091454150099413446771,-0.0010969651639699410164)	
(0.0038246054466374375565,-0.00019495911588837965033)	
(0.0096798495062914192977,0.0093997836832260765055)	
(0.0096726907209764619727,0.0093478433753704220227)	
(-0.00089675370102562028223,-0.00087091082356088021267)	
(0.0051511868212299879652,5.7308342649674273652e-05)	
(0.0096429639595594120183,0.0093144042674139487098)	
(0.0096270058720932822488,0.0094008687094721630345)	
(-0.00026313684444363157977,-0.000773293541280494043)	
(-0.00031183158513802921967,-0.0016985553028085790227)	
(0.0038071654770584256906,-0.0010318839369218831079)	
(0.0036592083777980725055,-0.0001743914564233071127)	
(0.0096322963102522373563,0.00943619576390978404)	
(0.0096168145664555573782,0.0094102832115738836022)	
(0.0097234112221850823449,0.0094924670610359151296)	
(0.0096645153476267835202,0.0094607121348229405999)	
(0.00064652048092759433536,-0.00157781849115267922)	
(0.0041957241825424243867,0.00066505012514427508039)	
(-0.0005715061077797208575,-0.001955609343210197755)	
(0.0032833191230380387796,0.001705270130468328248)	
(0.00091697080727823549514,-0.001665490964531695121)	
(0.0036113680208469918845,0.00078548944884869356491)	
(-0.00067376162443834927002,-0.0019714511585385381329)	
(0.0032492334166652884521,0.0018110135841689469285)	
(-0.00012368232464289084338,-0.0023088085857562805868)	
(-0.0004711042961059788421,-0.0021178638807889580385)	
(0.0039102262247112228727,0.00098642522460135962162)	
(0.0027341563481472481827,0.0011088452994963957955)	
(0.0043301069086121623045,0.0012171076310303612523)	
(0.0028759103153705779278,0.001635577010477094707)	
(0.0060502187253620156801,0.000455935634639428552)	
(0.0061660044805871821322,0.0008201812475346672562)	
(-0.0012889831532757419809,0.0017694226118661470371)	
(-0.0014437070842971452388,0.0016423801111660374548)	
(-0.00044494494599506522869,0.0015862379386273636576)	
(-0.00059470192522916378881,0.0017779419069215548956)	
(0.0092913161077911414487,0.007331161229679012889)	
(0.0062879036295507969787,0.0097847267914756494434)	
(0.0092132696782555815324,0.0072264471270576105186)	
(0.0063587483751234626789,0.009416748447898427507)	
(0.0063700808421811340454,0.0091884040677917902529)	
(0.0058901930687261065678,0.0097996450427098851649)	
(0.009821450847718854113,0.0095311182315955811362)	
(0.0098501418867484903663,0.0095659948107706220533)	
(0.009818224250427262656,0.0094847534323693003661)	
(0.0097828230312878641795,0.009505560171802093089)	


real	188m36.759s
user	131m41.304s
sys	55m28.332s
