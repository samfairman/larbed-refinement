clang++ -std=c++14 -stdlib=libc++ -O3 -ferror-limit=2 -Weverything -Wno-c++98-compat -Wno-c++98-compat-pedantic -Wno-sign-conversion -Wno-exit-time-destructors -Wno-float-equal -Wno-global-constructors -Wno-missing-declarations -Wno-unused-parameter -Wno-padded -Wno-shadow -Wno-weak-vtables -Wno-missing-prototypes -Wno-unused-variable -ferror-limit=1 -Wno-deprecated -Wno-conversion -Wno-double-promotion -c src/direct_cuda_pattern.cc -o ./obj/direct_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1
nvcc src/cuda_pattern.cu -o ./obj/_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1 -m64 -dc -gencode arch=compute_70,code=sm_70 --relocatable-device-code true  -Xptxas -v
ptxas info    : 9754 bytes gmem
ptxas info    : Compiling entry function '_Z5ZaxpymddP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZaxpymddP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 392 bytes cmem[0]
ptxas info    : Function properties for cudaGetDevice
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5DasummP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z5DasummP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 26 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z8sum_diagP7double2mdd' for 'sm_70'
ptxas info    : Function properties for _Z8sum_diagP7double2mdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 10 registers, 384 bytes cmem[0]
ptxas info    : Compiling entry function '_Z5ZgemmP7double2S0_S0_md' for 'sm_70'
ptxas info    : Function properties for _Z5ZgemmP7double2S0_S0_md
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 40 registers, 8704 bytes smem, 392 bytes cmem[0]
ptxas info    : Function properties for cudaFuncGetAttributes
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z22extract_intensity_diffP7double2PdS1_mm' for 'sm_70'
ptxas info    : Function properties for _Z22extract_intensity_diffP7double2PdS1_mm
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 392 bytes cmem[0], 8 bytes cmem[2]
ptxas info    : Compiling entry function '_Z9compose_aPdPmS_dP7double2m' for 'sm_70'
ptxas info    : Function properties for _Z9compose_aPdPmS_dP7double2m
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 400 bytes cmem[0]
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessor
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5ZscalmdP7double2' for 'sm_70'
ptxas info    : Function properties for _Z5ZscalmdP7double2
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 27 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaMalloc
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm' for 'sm_70'
ptxas info    : Function properties for _Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm
    24 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 72 registers, 448 bytes cmem[0], 104 bytes cmem[2]
ptxas info    : Compiling entry function '_Z5ZcopymP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZcopymP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaDeviceGetAttribute
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z6Dznrm2mP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z6Dznrm2mP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd' for 'sm_70'
ptxas info    : Function properties for _Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 416 bytes cmem[0], 8 bytes cmem[2]
nvcc -dlink ./obj/_cuda_pattern.o -arch=sm_70 -o ./obj/cuda_pattern.o -m64 -lcudadevrt -L/usr/local/cuda/lib64  -rdc=true -Xptxas -v
clang++ -o ./bin/direct_cuda_pattern ./obj/_cuda_pattern.o ./obj/direct_cuda_pattern.o ./obj/cuda_pattern.o  -lcudadevrt -lcublas -lcudart -m64 -L/usr/local/cuda/lib64  -lc++ -lc++abi -O3 -pthread

solution:
(0.84448516666611161963,-0.011180767226814023602)	
(0.0026159303595733279617,0.005023488941899172805)	
(0.0018764306876685177272,0.0048663090137465291746)	
(0.05267203842110511347,0.007255506106638858442)	
(0.052405294517587665271,0.0072522071069741744082)	
(0.002339091766964126063,0.0054969642743583971289)	
(0.042402822484513727486,0.0098481295876723471544)	
(0.042209098853037065047,0.0099704668422927883453)	
(-0.0031849227775204301712,0.0092056788405504644257)	
(-0.0033795727427893273997,0.0091051370933873491953)	
(-0.0032539622903918108583,0.0097473872552386146839)	
(-0.0032348768407589037141,0.010187007432028435255)	
(0.018841077185339786398,0.0044670315005349205822)	
(0.018797120609819695236,0.0044717238603213249615)	
(0.00094374406358935214977,-0.0011622614104325826052)	
(0.0010498244062687373847,-0.00066123690805386283863)	
(0.025443340014487433876,-0.0042256686647725765285)	
(0.025732957171962736465,-0.0047355754592722501192)	
(0.00017052331774373643983,-0.00076966790532867468671)	
(8.2820214277983442001e-06,1.0168071853455116273e-05)	
(-0.0086897007405434059657,0.0073854183429298680269)	
(0.025236006232011332084,-0.0051623097805337733734)	
(0.052455837723621598356,0.007155267605172489255)	
(-0.12074041729014306501,-0.0048125023016774804915)	
(-0.0080288568566209382593,0.006538089029803133452)	
(0.070289781745740159691,-0.019656159896860848912)	
(-0.007917184560338715385,0.0071845486952127283337)	
(0.025331119211002412622,-0.0046523457427112835383)	
(-0.12050759311217919267,-0.0043309722824782957359)	
(0.070049337877888542825,-0.019855967285394238164)	
(-0.003907266608951043621,-0.036459859545736356123)	
(-0.022425147470846215625,-0.015285515004188168428)	
(0.16439755694917207451,-0.049038980110907542942)	
(0.087749370687703234784,-0.02841896038591123011)	
(-0.003959297359769272176,-0.036224663195689163486)	
(-0.021942740796528904107,-0.015532640865359570795)	
(0.16478102647319706198,-0.049706097662165167617)	
(0.088139133173751590955,-0.028678343413281310453)	
(0.001985653345656893283,0.0054835580044957921153)	
(0.042545633263604602792,0.0098671477158628808496)	
(0.042341921144156906276,0.0099824319628092662848)	
(-0.0033024725974819795632,0.0093188698278880242182)	
(-0.0035343739671411657059,0.0091730170338788878659)	
(0.025354860196981219428,-0.0052338894987944712539)	
(0.025470123817601445643,-0.0047366557610831168737)	
(-0.022702031642456994842,-0.015419555403518451012)	
(-0.016173228658372330174,0.02180548050894751122)	
(-0.021881732859420525289,-0.01543980258518553618)	
(-0.016724172834989895625,0.021910038229872013521)	
(-0.0034020260165177930445,0.010016145464589593095)	
(0.052549805683382168342,0.0072368629354014430907)	
(0.018483888597342530008,0.0044606909461928946625)	
(-0.0033640775522416816769,0.0098317708043093709341)	
(0.00085263672054326528505,-0.00051600028735094172639)	
(0.018789612237687842305,0.0044058002292449577331)	
(0.00087989926900690319193,-0.0010131418050211961433)	
(-0.120746800732888529,-0.0052789181198570137021)	
(-0.096188822811968305304,0.094956045625102597496)	
(-0.12040964824151574597,-0.0047117893529664512872)	
(-0.09671002137185789882,0.094867869703394350211)	
(0.16432119726649510594,-0.049240057863927599868)	
(-0.016324164895644199813,0.022100699672472152307)	
(-0.0558736453237528366,0.062948516049607744494)	
(0.16467840794003651972,-0.049453531823174502746)	
(-0.016780422224617726895,0.022268997894430982848)	
(-0.0558293050278780012,0.062881361409411654084)	
(0.025654136812301723408,-0.0050071987072698555601)	
(-0.0085771511132009745082,0.0070571008370308154975)	
(-0.000190208739367092567,0.00035813786663015112228)	
(0.025408388161649742704,-0.0045400532587776916069)	
(0.070367591748080521308,-0.019405239534619929398)	
(0.00014231187312305652111,-0.00034954281268998940984)	
(0.070029407034459423276,-0.019555770048207587325)	
(0.088267292338044672784,-0.028355105762398895991)	
(0.08807652127600318348,-0.028754369746470928582)	
(-0.0037868787502036618114,-0.036233641961906787321)	
(-0.021811691758301814809,-0.015664077354432731637)	
(-0.021716293228182536462,-0.015798447180325986966)	
(-0.12089120388717805588,-0.0042356559355888404039)	
(-0.12081961951408741462,-0.0048387713077912737625)	
(0.089178400521625289521,-0.027151360280667662106)	
(-0.019732548742657590735,0.2478364011413943524)	
(-0.0033767413574281204651,-0.036221103935163749543)	
(-0.022198533927984657327,-0.015623833451985334742)	
(-0.12086831913867916721,-0.004387385962599446923)	
(0.088661356071472824381,-0.027518446764243215813)	
(-0.022483968150230897176,-0.015998911593589314195)	
(-0.02011475264683901254,0.24796760447155472007)	
(-0.12091416375256931748,-0.0050075303518664357819)	
(0.08897265206052237807,-0.027374828867662119591)	
(-0.019871775631065190931,0.24659160614662603561)	
(0.089478940121806141428,-0.027060392414040384396)	
(-0.018708590520041628452,0.24644058207718450015)	
(0.16328665016600824034,-0.049179010025854306976)	
(-0.016037835188040274609,0.022440750382240550603)	
(-0.095862955881472936004,0.095423643159012541681)	
(-0.016139632877776421971,0.022678809706771455024)	
(0.16337517423247177595,-0.049690841477905409174)	
(-0.016305729992323866884,0.022511899470439449694)	
(-0.096182651022491919002,0.09568641595404217548)	
(-0.016197321083077594051,0.022997640648130149993)	
(0.16313226812798911625,-0.049272919618167682065)	
(-0.057322074518554706757,0.065606966495831031683)	
(0.16326749772882084843,-0.049459747333935648317)	
(-0.057602410476063931055,0.065361333008522926047)	

