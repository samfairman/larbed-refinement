clang++ -std=c++14 -stdlib=libc++ -O3 -ferror-limit=2 -Weverything -Wno-c++98-compat -Wno-c++98-compat-pedantic -Wno-sign-conversion -Wno-exit-time-destructors -Wno-float-equal -Wno-global-constructors -Wno-missing-declarations -Wno-unused-parameter -Wno-padded -Wno-shadow -Wno-weak-vtables -Wno-missing-prototypes -Wno-unused-variable -ferror-limit=1 -Wno-deprecated -Wno-conversion -Wno-double-promotion -c src/direct_cuda_pattern.cc -o ./obj/direct_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1
nvcc src/cuda_pattern.cu -o ./obj/_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1 -m64 -dc -gencode arch=compute_70,code=sm_70 --relocatable-device-code true  -Xptxas -v
ptxas info    : 9754 bytes gmem
ptxas info    : Compiling entry function '_Z5ZaxpymddP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZaxpymddP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 392 bytes cmem[0]
ptxas info    : Function properties for cudaGetDevice
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5DasummP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z5DasummP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 26 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z8sum_diagP7double2mdd' for 'sm_70'
ptxas info    : Function properties for _Z8sum_diagP7double2mdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 10 registers, 384 bytes cmem[0]
ptxas info    : Compiling entry function '_Z5ZgemmP7double2S0_S0_md' for 'sm_70'
ptxas info    : Function properties for _Z5ZgemmP7double2S0_S0_md
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 40 registers, 8704 bytes smem, 392 bytes cmem[0]
ptxas info    : Function properties for cudaFuncGetAttributes
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z22extract_intensity_diffP7double2PdS1_mm' for 'sm_70'
ptxas info    : Function properties for _Z22extract_intensity_diffP7double2PdS1_mm
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 392 bytes cmem[0], 8 bytes cmem[2]
ptxas info    : Compiling entry function '_Z9compose_aPdPmS_dP7double2m' for 'sm_70'
ptxas info    : Function properties for _Z9compose_aPdPmS_dP7double2m
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 400 bytes cmem[0]
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessor
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5ZscalmdP7double2' for 'sm_70'
ptxas info    : Function properties for _Z5ZscalmdP7double2
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 27 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaMalloc
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm' for 'sm_70'
ptxas info    : Function properties for _Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm
    24 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 72 registers, 448 bytes cmem[0], 104 bytes cmem[2]
ptxas info    : Compiling entry function '_Z5ZcopymP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZcopymP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaDeviceGetAttribute
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z6Dznrm2mP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z6Dznrm2mP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd' for 'sm_70'
ptxas info    : Function properties for _Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 416 bytes cmem[0], 8 bytes cmem[2]
nvcc -dlink ./obj/_cuda_pattern.o -arch=sm_70 -o ./obj/cuda_pattern.o -m64 -lcudadevrt -L/usr/local/cuda/lib64  -rdc=true -Xptxas -v
clang++ -o ./bin/direct_cuda_pattern ./obj/_cuda_pattern.o ./obj/direct_cuda_pattern.o ./obj/cuda_pattern.o  -lcudadevrt -lcublas -lcudart -m64 -L/usr/local/cuda/lib64  -lc++ -lc++abi -O3 -pthread

solution:
(0.96088069640225814982,-0.013501224166846079525)	
(0.031769377314844637894,-0.014302688798653116764)	
(0.031769377196958811793,-0.014302688599361870064)	
(0.024056698676737559711,-0.0034229333648997002648)	
(0.024056698793469166731,-0.0034229332417783412366)	
(0.016366600145744380351,-0.0067959803566513387468)	
(0.016366600377631462804,-0.0067959805032484343207)	
(0.031769377430196865664,-0.014302688413750774127)	
(0.02969421566201289539,-0.006785331415380150763)	
(0.029694214947857872078,-0.0067853316220186218541)	
(0.018357156814457379485,-0.008858304965086490762)	
(0.018357156954664718279,-0.0088583047838102814409)	
(0.01869926275265738902,-0.0055245022917867750087)	
(0.018699262404967758461,-0.0055245024160907657204)	
(0.031769377298405725163,-0.01430268855922206192)	
(0.02969421496404320987,-0.0067853317859552725669)	
(0.029694215244092804495,-0.0067853317840687434395)	
(0.018357156622456530237,-0.0088583047199695778839)	
(0.018357156894033097028,-0.0088583047918045776381)	
(0.018699262710491132422,-0.0055245025604078344325)	
(0.018699262601725406829,-0.0055245026652605798423)	
(0.024056698760591344738,-0.0034229333487427763758)	
(0.018357156717964014103,-0.0088583050905446988205)	
(0.018357156673742887343,-0.0088583047430234040931)	
(0.021285884736205726298,-0.0039835434574336022612)	
(0.02128588429295179274,-0.0039835431135717136453)	
(0.018106404809447154691,-0.006075883250928743734)	
(0.01810640459647575376,-0.0060758832648056433634)	
(0.024056698500218152981,-0.0034229335170143145722)	
(0.018357156764493572088,-0.0088583045950469292695)	
(0.018357156639317352004,-0.008858304989773269425)	
(0.021285884504768967651,-0.0039835429443995295715)	
(0.021285884584344688664,-0.0039835435513933693114)	
(0.018106404679006982139,-0.0060758831350693712908)	
(0.018106404991398841048,-0.0060758831515082822872)	
(0.016366599685826366956,-0.0067959795895201754665)	
(0.018699263378398580521,-0.0055245026675690171378)	
(0.01869926239215984054,-0.0055245025068414504651)	
(0.018106404098415969373,-0.0060758830759854651204)	
(0.018106404276314758822,-0.0060758828423255039491)	
(0.016366599629050900683,-0.006795979714921559188)	
(0.018699262106931534289,-0.0055245027736328059659)	
(0.018699262979844498422,-0.0055245027512544645984)	
(0.018106404155473425355,-0.0060758831412339626976)	
(0.018106403776707261088,-0.0060758829161585425904)	
(0.0055281602470868308752,0.011208628639971553176)	
(0.0057013766043991168792,0.01070503679894824374)	
(0.0057013769778729217128,0.01070503698517799758)	
(0.0066399841471475829977,0.0094067447992174403615)	
(0.006639983958777726826,0.0094067447273824406073)	
(0.0059446391958912067274,0.0099690393853452165251)	
(0.0059446390006812743073,0.0099690392396487702981)	
(0.0055281603955136269027,0.011208628639971553176)	
(0.005701376592998991244,0.010705036964882931605)	
(0.0057013764678227694255,0.010705037300103456555)	
(0.006639983935301990714,0.0094067448635084677244)	
(0.0066399844075207730201,0.0094067447919270411744)	
(0.0059446390800318334169,0.0099690393538751885527)	
(0.0059446391778761658795,0.0099690391135719008675)	
(0.0077280990034401036634,0.0094428622795742905849)	
(0.0078685137771687414104,0.0093040475285217864171)	
(0.0078685135895027805142,0.0093040474083559369239)	
(0.0085467271158454153485,0.0090817689474988923248)	
(0.0085467268627342080078,0.0090817687249570722835)	
(0.0077074380703293053629,0.0087934716206438130054)	
(0.0077074383550788765074,0.0087934721266126510131)	
(0.0077280991719368046303,0.0094428621771983200367)	
(0.0078685137169590291945,0.0093040473677658067087)	
(0.0078685136198470041757,0.0093040475374167250222)	
(0.0085467271393211505931,0.0090817686606660449206)	
(0.0085467271796861189054,0.0090817691303512280282)	
(0.0077074380951560076888,0.0087934719300801645475)	
(0.0077074380997444718461,0.0087934718082813591311)	
(0.0092974431933069701106,0.0095013048027874948132)	
(0.0094912039238860632789,0.0095151360162854820707)	
(0.0094912036782904170285,0.0095151363070028974894)	
(0.0097788739482137752856,0.009626527438565731648)	
(0.0097788739256102728825,0.009626527446728361942)	
(0.0092871289504217972161,0.0092252148388763787618)	
(0.0092871291784243133888,0.0092252147321655181278)	
(0.009297443485150191575,0.0095013047318815522374)	
(0.0094912037719966091398,0.0095151362340420916897)	
(0.0094912039168208259948,0.0095151360297404726646)	
(0.0097788738138890399232,0.0096265272445100209114)	
(0.0097788741148807749315,0.0096265272447635923808)	
(0.0092871293067812044769,0.0092252150623188446804)	
(0.0092871289150671994944,0.0092252148521062091874)	
(0.0055281600174797726824,0.011208628035708058032)	
(0.0057013768119098199444,0.010705036917481139044)	
(0.0057013767647331884195,0.01070503676446587886)	
(0.006639984262049486094,0.0094067446368285064645)	
(0.0066399847431632078726,0.0094067446235986777736)	
(0.007707437571876027578,0.0087934716785450887933)	
(0.007707437930065138762,0.0087934716089616993956)	
(0.0089057947349870884152,0.0089145289156688910931)	
(0.0089057949415687308325,0.0089145288089580321939)	
(0.0099232503465686624361,0.009813795438028143428)	
(0.0097380046163941073878,0.0094617510856846720468)	
(0.0099232509054568134726,0.0098137951017102254686)	
(0.009738004631903959471,0.0094617509153582680242)	
(0.005528160239317696581,0.011208628114579882035)	
(0.0057013769624198948338,0.010705036948472433644)	
(0.0057013770344516417204,0.010705036936621985938)	
(0.0066399845128806665728,0.0094067443999310499519)	
(0.0066399843304502407723,0.0094067445939583493875)	
(0.0077074378520939597695,0.0087934714308945758493)	
(0.007707437977945667297,0.0087934717606259933664)	
(0.0089057947997568491505,0.008914528487024160272)	
(0.0089057947783075658288,0.0089145286965613135255)	
(0.0099232508432206510685,0.009813795129295688896)	
(0.0097380049239723411036,0.0094617509383836811976)	
(0.0099232503230929254567,0.0098137954065581119861)	
(0.0097380048505612149673,0.0094617508599621810012)	
(0.0077280990829874099055,0.009442862907116772106)	
(0.0078685129054384059244,0.0093040472886119964663)	
(0.0078685129671958349562,0.0093040473469920056265)	
(0.0085467267831869017658,0.0090817686326302576871)	
(0.0085467270843753856413,0.0090817688886969723944)	
(0.0092871292573245486923,0.0092252150372385682831)	
(0.0092871290571326561153,0.009225215115238159444)	
(0.0097380047951651279442,0.009461751021647217888)	
(0.0097380048172614822044,0.0094617511910445647322)	
(0.0099729240478566242439,0.0099141686363525237391)	
(0.0099185511589585904912,0.0098164925338877252747)	
(0.0099729239929108592921,0.0099141681903398230086)	
(0.0099185510910081587516,0.0098164923594800061052)	
(0.0077280991082928473385,0.009442862554388356186)	
(0.0078685128981195954362,0.0093040472874861904207)	
(0.0078685131952267641647,0.0093040470585546170695)	
(0.0085467271573361897063,0.0090817686957954807392)	
(0.0085467268084923400662,0.0090817688337227961415)	
(0.0092871291052383474207,0.0092252150600672343239)	
(0.0092871292272338982349,0.0092252147289848505929)	
(0.0097380046006590916668,0.0094617508586112130525)	
(0.0097380048227505913716,0.0094617511078378523787)	
(0.0099729239972457493779,0.009914168064938439287)	
(0.0099185512050094168379,0.0098164924436157756371)	
(0.0099729240934571267846,0.009914168251703754306)	
(0.0099185511044631476107,0.0098164923695007524906)	
(0.0092974432995959199744,0.0095013058161329613793)	
(0.0094912030749559807979,0.0095151358851414159779)	
(0.0094912035024749055734,0.0095151359045074230397)	
(0.0097788737194789508017,0.0096265274590859577913)	
(0.0097788738168445490245,0.0096265271932236603364)	
(0.0099232500464491602693,0.0098137955789962053044)	
(0.0099232504516465671468,0.0098137957541362345198)	
(0.0099729240391300214702,0.0099141692557323749663)	
(0.0099729234718256634662,0.009914168810169996307)	
(0.0092974434658125958142,0.0095013054171285589444)	
(0.0094912032104065239407,0.0095151358522920052863)	
(0.0094912033875445903086,0.0095151357549548200992)	
(0.0097788738759000421591,0.009626527345760185414)	
(0.0097788736757081495821,0.0096265274704860834265)	
(0.0099232501709783111493,0.0098137958726975428603)	
(0.0099232501925959320371,0.0098137955557456319627)	
(0.0099729235085312274017,0.0099141690700928659929)	
(0.0099729236154956629745,0.0099141694153341355933)	

