clang++ -std=c++14 -stdlib=libc++ -O3 -ferror-limit=2 -Weverything -Wno-c++98-compat -Wno-c++98-compat-pedantic -Wno-sign-conversion -Wno-exit-time-destructors -Wno-float-equal -Wno-global-constructors -Wno-missing-declarations -Wno-unused-parameter -Wno-padded -Wno-shadow -Wno-weak-vtables -Wno-missing-prototypes -Wno-unused-variable -ferror-limit=1 -Wno-deprecated -Wno-conversion -Wno-double-promotion -c src/direct_cuda_pattern.cc -o ./obj/direct_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1
nvcc src/cuda_pattern.cu -o ./obj/_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1 -m64 -dc -gencode arch=compute_70,code=sm_70 --relocatable-device-code true  -Xptxas -v
ptxas info    : 9754 bytes gmem
ptxas info    : Compiling entry function '_Z5ZaxpymddP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZaxpymddP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 392 bytes cmem[0]
ptxas info    : Function properties for cudaGetDevice
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5DasummP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z5DasummP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 26 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z8sum_diagP7double2mdd' for 'sm_70'
ptxas info    : Function properties for _Z8sum_diagP7double2mdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 10 registers, 384 bytes cmem[0]
ptxas info    : Compiling entry function '_Z5ZgemmP7double2S0_S0_md' for 'sm_70'
ptxas info    : Function properties for _Z5ZgemmP7double2S0_S0_md
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 40 registers, 8704 bytes smem, 392 bytes cmem[0]
ptxas info    : Function properties for cudaFuncGetAttributes
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z22extract_intensity_diffP7double2PdS1_mm' for 'sm_70'
ptxas info    : Function properties for _Z22extract_intensity_diffP7double2PdS1_mm
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 392 bytes cmem[0], 8 bytes cmem[2]
ptxas info    : Compiling entry function '_Z9compose_aPdPmS_dP7double2m' for 'sm_70'
ptxas info    : Function properties for _Z9compose_aPdPmS_dP7double2m
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 400 bytes cmem[0]
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessor
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5ZscalmdP7double2' for 'sm_70'
ptxas info    : Function properties for _Z5ZscalmdP7double2
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 27 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaMalloc
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm' for 'sm_70'
ptxas info    : Function properties for _Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm
    24 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 72 registers, 448 bytes cmem[0], 104 bytes cmem[2]
ptxas info    : Compiling entry function '_Z5ZcopymP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZcopymP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaDeviceGetAttribute
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z6Dznrm2mP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z6Dznrm2mP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd' for 'sm_70'
ptxas info    : Function properties for _Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 416 bytes cmem[0], 8 bytes cmem[2]
nvcc -dlink ./obj/_cuda_pattern.o -arch=sm_70 -o ./obj/cuda_pattern.o -m64 -lcudadevrt -L/usr/local/cuda/lib64  -rdc=true -Xptxas -v
clang++ -o ./bin/direct_cuda_pattern ./obj/_cuda_pattern.o ./obj/direct_cuda_pattern.o ./obj/cuda_pattern.o  -lcudadevrt -lcublas -lcudart -m64 -L/usr/local/cuda/lib64  -lc++ -lc++abi -O3 -pthread
, thickness = (0,1), ug_size = 13, tilt_size= 5, column_index = 0, 
 ug = 
(0.23589499999999999358,0)	
(0.0005930819999999999842,-6.3790100000000002881e-09)	
(0.0005930819999999999842,6.3790100000000002881e-09)	
(0.082869600000000001594,-7.396030000000000153e-09)	
(0.082869600000000001594,7.396030000000000153e-09)	
(0.0005930819999999999842,-6.3790100000000002881e-09)	
(0.0005930819999999999842,6.3790100000000002881e-09)	
(0.082869600000000001594,-7.396030000000000153e-09)	
(0.064142500000000005067,0)	
(0.064142500000000005067,-5.735679999999999781e-09)	
(0.082869600000000001594,7.396030000000000153e-09)	
(0.064142500000000005067,5.735679999999999781e-09)	
(0.064142500000000005067,0)	


 ar0 = 
0	2	1	
1	0	4	
2	3	0	
,
 diag0 = 
0	
0.45458984000000002279	
-0.5854492199999999924	
, 
Intensity0 = 
0.99999762000000003148	
7.2999999999999999873e-07	
7.2999999999999999873e-07	


 ar1 = 
0	2	1	
1	0	4	
2	3	0	
,
 diag1 = 
0	
-0.065673830000000002483	
-0.065673830000000002483	
, 
Intensity1 = 
0.99989212000000005087	
5.3730000000000002259e-05	
5.3730000000000002259e-05	


 ar2 = 
0	2	1	
1	0	4	
2	3	0	
,
 diag2 = 
0	
-0.065429689999999998684	
-0.065429689999999998684	
, 
Intensity2 = 
0.9998922900000000169	
5.3650000000000003025e-05	
5.3650000000000003025e-05	


 ar3 = 
0	6	5	2	1	
5	0	10	12	11	
6	7	0	9	8	
1	8	11	0	4	
2	9	12	3	0	
,
 diag3 = 
-0.00024414000000000000371	
0.064208979999999998833	
-0.1960449200000000114	
-0.065917970000000006281	
-0.065917970000000006281	
, 
Intensity3 = 
0.9998552200000000445	
7.3780000000000001722e-05	
6.309999999999999725e-06	
3.300000000000000253e-05	
3.300000000000000253e-05	


 ar4 = 
0	1	2	
2	0	3	
1	4	0	
,
 diag4 = 
0	
0.45458984000000002279	
-0.5854492199999999924	
, 
Intensity4 = 
0.99999762000000003148	
7.2999999999999999873e-07	
7.2999999999999999873e-07	

Merit: 1.6812431197579847145e-05
ABS: 0.0047339429293795660253

ug=
1	0	0.0005930819999999999842	-6.3790100000000002881e-09	0.0005930819999999999842	6.3790100000000002881e-09	0.082869600000000001594	-7.396030000000000153e-09	0.082869600000000001594	7.396030000000000153e-09	0.0005930819999999999842	6.3790100000000002881e-09	0.064142500000000005067	0	0.0005930819999999999842	-6.3790100000000002881e-09	0.064142500000000005067	0	0	0	0	0	0	0	0	0	

a is 
0	0	
-6.3790100000000002881e-09	0.0005930819999999999842	
6.3790100000000002881e-09	0.0005930819999999999842	
6.3790100000000002881e-09	0.0005930819999999999842	
0	0.45458984000000002279	
-7.396030000000000153e-09	0.082869600000000001594	
-6.3790100000000002881e-09	0.0005930819999999999842	
7.396030000000000153e-09	0.082869600000000001594	
0	-0.5854492199999999924	
0.99999965611356533834	-2.2220068404892738662e-09	
-0.00015643700857293600117	0.00057324182763426748469	
0.00014460832079723584358	0.00056016288362387958635	
-0.00015642472233548293699	0.00057324415644900196271	
0.8951310969944121787	0.43873036719301966579	
0.0051711311154190942388	0.078923321361306406074	
0.00014459631588653395367	0.00056016703045227609573	
0.0051711452027538712395	0.078923320430852317298	
0.83022956244532364334	-0.55178157832728713661	
-1.2817901535746467623	-6.1262250890983800389	
0.0039986219734536301504	-0.0025920986419120739877	
0.0019454573606414377659	-0.0028515984111899188129	
0.0039985653198848294942	-0.0025921775899329117451	
1.6805483300304557837	-8.1260228008672825695	
0.37437029939680988022	-0.38548629625810776345	
0.0019455195951885112613	-0.0028515636283212952677	
0.37437023058186946756	-0.38548636303188166252	
-3.0178993616652238785	-3.2880485159938572792	
-19.710853616553386303	94.206465354735499318	
0.001957665211718541496	-0.030611153557617124671	
0.0018301834625966909714	-0.038500168707545294466	
0.001956979566901516799	-0.030611195226176682316	
-18.216918810630492231	70.349409397567171709	
0.26211435484700257303	-4.985533806624161457	
0.0018310388102521799134	-0.038500129764721301162	
0.26211346474470731405	-4.9855338534078557089	
-21.506528380446717108	132.9194543474284842	
39.173624106188114524	-1.2268846177785478498e-08	
-0.002999981210406611927	0.018864506987690144585	
0.0028053019636873595746	0.018783771311774492829	
-0.0029995756859540773781	0.018864551535267646415	
37.164229881471122496	14.455391617352313816	
0.10205017583065624509	2.6286377076025133626	
0.0028048981755868871574	0.01878385163522026946	
0.10205064503530746067	2.6286376892437104402	
35.883424185434300568	-18.534822322093155833	
-19.710853616553386303	-94.206465379273197414	
-0.001825958873238732981	-0.038681317052489234964	
-0.0019533924995316499611	-0.030953736697593870614	
-0.0018267643617132268974	-0.038681277328735011456	
-21.117064671161433154	-123.46927326933240465	
-0.2665686852971748122	-4.7109937975744395899	
-0.0019527532411914973274	-0.030953779147083654993	
-0.26656952600989108904	-4.7109937499892584611	
-17.771539204414828816	-64.344902534038837416	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
-6.3790100000000002881e-09	0.0005930819999999999842	
6.3790100000000002881e-09	0.0005930819999999999842	
6.3790100000000002881e-09	0.0005930819999999999842	
0	-0.065673830000000002483	
-7.396030000000000153e-09	0.082869600000000001594	
-6.3790100000000002881e-09	0.0005930819999999999842	
7.396030000000000153e-09	0.082869600000000001594	
0	-0.065673830000000002483	
0.9999996482624290417	-2.0161526460747570179e-09	
-5.1054800634447548366e-06	0.00059305317748133763896	
-5.0927691029780212058e-06	0.00059305222728320088586	
-5.0927691029780728748e-06	0.00059305222728320088586	
0.99441975037166585594	-0.065401420819523936601	
0.0054320469267747344827	0.082596339839286672668	
-5.1054800634446455694e-06	0.00059305317748133763896	
0.0054320616697259684405	0.082596338862090265542	
0.99441975037166585594	-0.065401420819523936601	
-1.2817901451480764319	-6.1262251275512253912	
0.0028808846141908520458	-0.0028613464893225137864	
0.0028808222841575077504	-0.00286140136981696434	
0.0028808222841575077504	-0.00286140136981696434	
-1.5596889393290882531	-5.8048664920849395443	
0.36142605469283917152	-0.40432104009318337035	
0.0028808846141908520458	-0.0028613464893225137864	
0.36142598251675867038	-0.40432110455626751877	
-1.5596889393290882531	-5.8048664920849395443	
-19.710853616553386303	94.206465354907251708	
0.0018943205618007653152	-0.034397088146684878796	
0.0018935534752347277319	-0.034397128451736813659	
0.0018935534752347277319	-0.034397128451736813659	
-19.918046562351673145	98.172802849253386626	
0.26210604071280524385	-4.9636443576558688662	
0.0018943205618007653152	-0.034397088146684878796	
0.26210515451772598006	-4.963644404438078972	
-19.918046562351673145	98.172802849253386626	
39.173624106188114524	-1.2097095514555880428e-08	
-9.618059790500661007e-05	0.018984565760419378627	
-9.5772492529632086752e-05	0.018984547843172869253	
-9.5772492529632086752e-05	0.018984547843172869253	
39.068410163339038377	-2.1006027212102029722	
0.10243097030710408835	2.651039373486526074	
-9.618059790500661007e-05	0.018984565760419378627	
0.10243144351040102402	2.6510393550597517454	
39.068410163339038377	-2.1006027212102029722	
-19.710853616553386303	-94.206465379101445023	
-0.0018893875458283625104	-0.034655328746294650211	
-0.0018901064307081628327	-0.03465528765903280739	
-0.0018901064307081628327	-0.03465528765903280739	
-19.499067365148956554	-90.523178601198765136	
-0.26657699952280183853	-4.6880799148441623103	
-0.0018893875458283625104	-0.034655328746294650211	
-0.26657783614544272588	-4.6880798672574979236	
-19.499067365148956554	-90.523178601198765136	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	
0	0	

 max dim 5, a.size = 500 ,data.cache =
 0x7f6b2c200000, offset =0

real	0m1.278s
user	0m0.160s
sys	0m0.696s
