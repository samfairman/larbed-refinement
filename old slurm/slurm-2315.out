clang++ -std=c++14 -stdlib=libc++ -O3 -ferror-limit=2 -Weverything -Wno-c++98-compat -Wno-c++98-compat-pedantic -Wno-sign-conversion -Wno-exit-time-destructors -Wno-float-equal -Wno-global-constructors -Wno-missing-declarations -Wno-unused-parameter -Wno-padded -Wno-shadow -Wno-weak-vtables -Wno-missing-prototypes -Wno-unused-variable -ferror-limit=1 -Wno-deprecated -Wno-conversion -Wno-double-promotion -c src/direct_cuda_pattern.cc -o ./obj/direct_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1
nvcc src/cuda_pattern.cu -o ./obj/_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1 -m64 -dc -gencode arch=compute_70,code=sm_70 --relocatable-device-code true  -Xptxas -v
ptxas info    : 9754 bytes gmem
ptxas info    : Compiling entry function '_Z5ZaxpymddP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZaxpymddP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 392 bytes cmem[0]
ptxas info    : Function properties for cudaGetDevice
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5DasummP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z5DasummP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 26 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z8sum_diagP7double2mdd' for 'sm_70'
ptxas info    : Function properties for _Z8sum_diagP7double2mdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 10 registers, 384 bytes cmem[0]
ptxas info    : Compiling entry function '_Z5ZgemmP7double2S0_S0_md' for 'sm_70'
ptxas info    : Function properties for _Z5ZgemmP7double2S0_S0_md
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 40 registers, 8704 bytes smem, 392 bytes cmem[0]
ptxas info    : Function properties for cudaFuncGetAttributes
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z22extract_intensity_diffP7double2PdS1_mm' for 'sm_70'
ptxas info    : Function properties for _Z22extract_intensity_diffP7double2PdS1_mm
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 392 bytes cmem[0], 8 bytes cmem[2]
ptxas info    : Compiling entry function '_Z9compose_aPdPmS_dP7double2m' for 'sm_70'
ptxas info    : Function properties for _Z9compose_aPdPmS_dP7double2m
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 400 bytes cmem[0]
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessor
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5ZscalmdP7double2' for 'sm_70'
ptxas info    : Function properties for _Z5ZscalmdP7double2
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 27 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaMalloc
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm' for 'sm_70'
ptxas info    : Function properties for _Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm
    24 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 72 registers, 448 bytes cmem[0], 104 bytes cmem[2]
ptxas info    : Compiling entry function '_Z5ZcopymP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZcopymP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaDeviceGetAttribute
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z6Dznrm2mP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z6Dznrm2mP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd' for 'sm_70'
ptxas info    : Function properties for _Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 416 bytes cmem[0], 8 bytes cmem[2]
nvcc -dlink ./obj/_cuda_pattern.o -arch=sm_70 -o ./obj/cuda_pattern.o -m64 -lcudadevrt -L/usr/local/cuda/lib64  -rdc=true -Xptxas -v
clang++ -o ./bin/direct_cuda_pattern ./obj/_cuda_pattern.o ./obj/direct_cuda_pattern.o ./obj/cuda_pattern.o  -lcudadevrt -lcublas -lcudart -m64 -L/usr/local/cuda/lib64  -lc++ -lc++abi -O3 -pthread
Steepest Descent terminate with total step 1000

solution:
(0.99964604364232778622,-0.00030936823475774684854)	
(-0.0012335447416742077731,0.0004621180203329452031)	
(0.00047268331926186526364,0.00027727645047401916359)	
(-0.006372122007185805799,-0.018166328326000687199)	
(0.014643008200765748536,0.01305712215305780341)	
(0.017212245364714783696,0.0036100346743261932207)	
(0.014081177766775783769,-0.015260870320133250802)	
(0.063798958098226887792,-0.012178566330112860702)	
(0.00050879076971852119256,0.0022109962062190247241)	
(-0.0012703437568382842677,0.0012558123252723828438)	
(0.0015584210941769812558,-0.0011630026709564119606)	
(-0.00073437334221861485292,-0.00019448963869001946567)	
(0.063575873079565123347,0.013509163811184570284)	
(-9.9561779582782176565e-05,0.0015754248361048300842)	
(0.00071432283968115846233,-0.0012261336867974191936)	
(-0.0001189374532738119339,0.0014845251701110962102)	
(0.0007197426340311385666,-0.00033694713568470515503)	
(-0.015137422556431081103,0.011266816211274094384)	
(-0.0022999663751927814336,0.0015637280123922689748)	
(0.00055915312425827657858,-0.0016650860033651428832)	
(0.0057113030367955631636,-0.0084603723942489710008)	
(-0.010292421232908103776,-0.04904238408086167289)	
(0.0012399905388043182784,0.0042732653486645087726)	
(-0.016834251118064469388,-0.010380807230357450704)	
(0.0022592635288374565347,0.00040006774986849476207)	
(9.7682242350113492415e-05,-0.0017603667769515820348)	
(-0.009566045738350846192,0.0052949732090420689387)	
(0.0034037026018319629407,0.0028280895998414848531)	
(0.043792916232950743205,0.024451553325308215264)	
(0.010404401496986778741,0.018467288700882926455)	
(0.00029041368555781727412,0.0011939607087780089272)	
(-0.00012836251493916051416,-0.0023033638757997379649)	
(0.018298166085332051578,0.045951412842464040009)	
(0.0017473771975427131349,0.0032878353812219773995)	
(-0.00080740617389403631071,0.0054073396676804792033)	
(-0.017031155654493951301,-0.010410264914245532381)	
(0.0014004932694151328316,0.0013833824545788895623)	
(0.00010187557470983020459,-0.00067959818690921673569)	
(0.00062545095842224905907,-0.0044710583112162359185)	
(0.0010684480089144579845,-0.05014142903544982488)	
(-0.00016344815429591904319,0.0029492329146180123849)	
(0.001249626632520288742,-0.00014329166580143834942)	
(-0.0095349349551496886263,-0.0038197886767391445)	
(-0.0035694212160787071493,0.0042451773535840016394)	
(0.0033187159912144875186,0.00048919484332112948746)	
(0.00010603497464475397736,-0.00046893448658935551207)	
(-0.00047014422974908252808,-0.0015905296265456057934)	
(-0.0021638740589180814437,-0.0061781728165829705168)	
(-0.0031102847304714190818,-0.0047609599214799239869)	
(0.012641548653556298337,-0.0020350647185458543842)	
(-0.00040956368466420032962,-0.00035458053751365268408)	
(-0.0010805619317069718385,0.000714543708370839626)	
(0.0069416523446351281398,-0.0056890149564301087728)	
(-0.017457016655754054035,-0.039498283675924825142)	
(0.00013018460901770105564,0.0014514572311978279906)	
(-0.0017852813049658371961,0.0017811229165472345932)	
(-0.0039341326847361617752,-0.00058945214076430610221)	
(-0.0041277047444178384047,0.007407121631086864208)	
(0.00031459298998805164567,0.0013640263296882191701)	
(-0.0012032145503785595438,-5.2571991523954028267e-05)	
(0.00074670231192113835361,-0.0089890198262419160335)	
(0.029082460421912297716,0.031750982348301176605)	
(-0.0027370238222572383126,-0.00060015648252297569554)	
(-6.129874296172993411e-05,-0.0006699177089834274304)	
(0.0041326052603160075977,0.0016306928430926664192)	
(-0.012504093063458515331,-0.0020369724987935981797)	
(0.00016739201231583361422,0.00033018668339074205278)	
(-0.0058585222345138663474,0.00017688561334451715452)	
(-0.00094470833673860991897,0.00077929337007507607383)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	
(0.010000000000000000208,0.010000000000000000208)	


real	175m46.299s
user	122m28.176s
sys	51m48.936s
