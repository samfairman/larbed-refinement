clang++ -std=c++14 -stdlib=libc++ -O3 -ferror-limit=2 -Weverything -Wno-c++98-compat -Wno-c++98-compat-pedantic -Wno-sign-conversion -Wno-exit-time-destructors -Wno-float-equal -Wno-global-constructors -Wno-missing-declarations -Wno-unused-parameter -Wno-padded -Wno-shadow -Wno-weak-vtables -Wno-missing-prototypes -Wno-unused-variable -ferror-limit=1 -Wno-deprecated -Wno-conversion -Wno-double-promotion -c src/direct_cuda_pattern.cc -o ./obj/direct_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1
nvcc src/cuda_pattern.cu -o ./obj/_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1 -m64 -dc -gencode arch=compute_70,code=sm_70 --relocatable-device-code true  -Xptxas -v
ptxas info    : 9754 bytes gmem
ptxas info    : Compiling entry function '_Z5ZaxpymddP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZaxpymddP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 392 bytes cmem[0]
ptxas info    : Function properties for cudaGetDevice
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5DasummP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z5DasummP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 26 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z8sum_diagP7double2mdd' for 'sm_70'
ptxas info    : Function properties for _Z8sum_diagP7double2mdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 10 registers, 384 bytes cmem[0]
ptxas info    : Compiling entry function '_Z5ZgemmP7double2S0_S0_md' for 'sm_70'
ptxas info    : Function properties for _Z5ZgemmP7double2S0_S0_md
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 40 registers, 8704 bytes smem, 392 bytes cmem[0]
ptxas info    : Function properties for cudaFuncGetAttributes
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z22extract_intensity_diffP7double2PdS1_mm' for 'sm_70'
ptxas info    : Function properties for _Z22extract_intensity_diffP7double2PdS1_mm
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 392 bytes cmem[0], 8 bytes cmem[2]
ptxas info    : Compiling entry function '_Z9compose_aPdPmS_dP7double2m' for 'sm_70'
ptxas info    : Function properties for _Z9compose_aPdPmS_dP7double2m
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 400 bytes cmem[0]
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessor
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5ZscalmdP7double2' for 'sm_70'
ptxas info    : Function properties for _Z5ZscalmdP7double2
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 27 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaMalloc
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm' for 'sm_70'
ptxas info    : Function properties for _Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm
    24 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 72 registers, 448 bytes cmem[0], 104 bytes cmem[2]
ptxas info    : Compiling entry function '_Z5ZcopymP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZcopymP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaDeviceGetAttribute
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z6Dznrm2mP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z6Dznrm2mP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd' for 'sm_70'
ptxas info    : Function properties for _Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 416 bytes cmem[0], 8 bytes cmem[2]
nvcc -dlink ./obj/_cuda_pattern.o -arch=sm_70 -o ./obj/cuda_pattern.o -m64 -lcudadevrt -L/usr/local/cuda/lib64  -rdc=true -Xptxas -v
clang++ -o ./bin/direct_cuda_pattern ./obj/_cuda_pattern.o ./obj/direct_cuda_pattern.o ./obj/cuda_pattern.o  -lcudadevrt -lcublas -lcudart -m64 -L/usr/local/cuda/lib64  -lc++ -lc++abi -O3 -pthread

solution:
(0.59306451950090754988,0.018939945678393542428)	
(-0.0026906531093333096484,0.00040311617895429666071)	
(0.0023675157687438300354,0.0031928831262641628463)	
(0.0034876737240746419864,0.0021953540662931719622)	
(-0.00020590055310289824336,0.011828090302926074287)	
(0.034464478610236763678,-0.0029550306291554707602)	
(-0.0030949962220758971999,-0.00093353194502594554968)	
(0.09583214522833986837,0.011596317059926222054)	
(0.022202385237655258149,0.0042091830880421699304)	
(0.060701830397132804096,0.023651187902966799154)	
(1.4123765974329271152e-05,0.0062738398154512028948)	
(0.015135258860887762511,0.0036622030111447424067)	
(-0.00018459973612501754899,0.0096462597255035659877)	
(0.050754224523229890531,-0.01204020604463625424)	
(0.002205573043626028306,-0.010643558245199385981)	
(-0.0011873215678220969301,0.0039971055374690067294)	
(0.049573726801407133613,0.0090529440345555114988)	
(-0.0077196298722774841714,0.0012613700169542953287)	
(-0.0023676671293755098199,0.022174747343268227939)	
(0.0083643392751575895705,0.0023919722289866170162)	
(0.019178151796348668484,-0.00075212792487515660756)	
(0.0083295344294121286682,0.00045710746254295689774)	
(-0.037082287077111523999,0.0075355720301272018785)	
(0.027324932420151791523,0.0062398115398588516883)	
(-0.015835001558612091938,-0.01708291587263796249)	
(0.0058879134192155700711,0.0069323075861263015393)	
(-0.01476242952214236806,-0.012889561460491374967)	
(0.0048393489214748793004,0.0077713898393715714549)	
(-0.013744162821962472784,-0.0079833522624690473474)	
(-0.0016984983121179008606,0.026927871513586915109)	
(0.012581238866252033443,0.0021550710757372213387)	
(0.007369939061963487123,-0.0074399137119052355382)	
(0.0025538847988652840088,-0.0069873939723023607493)	
(0.01514836667555451849,-0.017376523325757467497)	
(0.0093164217343941688187,0.0055720414548338023653)	
(0.010315339777817214909,-0.0039255119130955744289)	
(1.7649490948090196248e-06,0.0048705058055279887297)	
(-0.016563873515286330756,0.015250739996701040413)	
(-0.027534986698314889431,0.018089509915854559002)	
(-0.0034307914876248526981,-0.0061260920486746785196)	
(-0.011182937483458303338,-0.031557943662978864274)	
(0.016677793405133822108,0.0018187214910053161893)	
(0.0051525322069059641822,0.0097062408174867949306)	
(-0.015554500777890608448,0.015170790065174910577)	
(-0.0036594470244444630806,-0.016058336309998356289)	
(0.013616574112039307731,0.060808356421712166096)	
(-0.0087234698846804722971,0.01057366407473806294)	
(0.0014918733958656407289,-0.0075629374218571495184)	
(-0.0019711895752238463471,0.0051530158694616454151)	
(0.0063911588949578570368,-0.0071272186008191820011)	
(-0.0079929222078708242472,0.002502773994922631931)	
(-0.1071304845440820136,0.0037414598344295323454)	
(0.0026747073498009639285,0.0067756602939936603353)	
(0.00026120023237406297771,0.0053915934194936699156)	
(-0.10432162133066770482,0.0054911963222130360379)	
(0.0011392744087415013817,-0.017565784667003314645)	
(0.03919907231744344106,-0.21845551489459499872)	
(0.010288580036414305893,-0.0040133643338335816056)	
(-0.0015297674957771532911,-0.0013361106826434733779)	
(-0.20889382887371335529,-0.15511008891976771351)	
(0.0033827956016881433922,0.01091740637107339526)	
(0.001956137519986348404,0.0082378595528614338706)	
(-0.012495120256445566356,-0.0021979777218495127195)	
(-0.042954830878847598263,0.0050092126604090753822)	
(-0.005890540134272896286,0.0089026940819821667739)	
(-0.0013195696664917439932,0.00079919529432595937807)	
(-0.029398584704158802622,0.0036704002082217248963)	
(0.00061426235779749125548,0.0032260542650489236818)	
(-0.027443954897676980931,0.017129329558148491397)	
(0.052258168725547754496,-0.033731944745289857424)	
(0.10855062643959975666,-0.014393252461233871017)	
(-0.029147138093622085298,0.068156290216676462812)	
(-0.053782534202611836927,-0.066986598448770889869)	
(0.029975887780413382894,-0.052989996980361456225)	
(0.10612729436112432191,0.089468590624384114474)	
(-0.0022762042007319219575,0.0036740813378795668213)	
(0.0014758904069118268174,-0.005426165107025836265)	
(0.037470473285594156632,-0.22182912757141554083)	
(0.00095772640884986715449,0.013651006005842170749)	
(-0.01660509817243116179,-0.019618710470647508087)	
(0.00093831338395983362663,-0.017815879656351278626)	
(0.019809641821577850251,0.004724633507882504066)	
(-0.021755775428953794126,0.011855341727568144763)	
(-0.044713851919203850827,-0.030683749893449796531)	
(-0.025236142693848981344,0.014321230094726092319)	
(0.033469572727262648926,-0.0041903392618447849599)	
(-0.04697579361817694199,-0.027334413483857809835)	
(-0.10714129750489161108,-0.0015810416707898900402)	
(-0.089675136208161213003,0.037188832663192450401)	
(-0.058366949533144675544,0.044514557253798194003)	
(-0.085012358914088065331,-0.052941885865958750179)	
(-0.018062147339633780052,0.015844991560835075539)	
(0.0084454519421148527974,-0.029645844046604113986)	
(0.00024532946603223897185,0.0044040201511981267452)	
(-0.00038517981886308680058,0.00200564310199048473)	
(-0.056633498053328588939,0.044522407965403014429)	
(0.013793529433327908831,0.0037950284639068523722)	
(-0.017060787255208077762,0.016882407928955199539)	
(-0.087766062719563345262,-0.05163277705498054565)	
(-0.20983012332188832882,-0.15387331499317608019)	
(-0.013810055139607282232,-0.00080707426213550087848)	
(0.019435832742386381644,-0.00109482745905217305)	
(-0.030657587388470380896,0.0085076979248781756104)	
(0.028299415310154465986,0.007773936265450802352)	
(-0.013529201395647822911,-0.019322160446735871936)	
(-0.0163496455151606844,0.01515257315001405751)	
(-0.0030081533981483762029,-0.016951333222043070414)	
(0.095982898140427458378,0.0074905596316898756873)	
(0.052383275058404066282,0.010903929472409069901)	
(0.0025311746292937423002,0.023574458369746705)	
(0.0019920783218045964164,0.0045704656683687346075)	
(-0.01160586381050167544,-0.010423854065843137992)	
(0.01035071588552841787,-0.020786464683223346978)	
(-0.088871147278455742136,0.042275120571593299834)	
(-0.10812016731647741685,0.0054993334665061257421)	
(-0.052295336511029452686,-0.074881246359493849885)	
(0.061958013716917233193,0.01895396536341503041)	
(-0.030602177853848732542,0.069367574280726346236)	
(0.056602519482095499381,-0.0068200725999275476838)	
(-0.01915306156339195362,0.017683848773311798552)	
(0.0087855927228402512508,-0.032022646246092044409)	
(-0.031154980258411190536,0.024188521043599257171)	
(-0.011777929780641056487,-0.029289981755875885844)	
(0.01208623936139426383,0.055605055568864067417)	
(-0.0062480459068835862702,-0.01198939356273722584)	
(0.048972687303293786776,-0.034202344348350288694)	
(0.1081037204487279163,-0.014456266799963157083)	
(-0.0029556838299105853141,-0.010670162633402808031)	
(-0.0057060260584811672846,0.030542815504133118132)	


real	49m14.406s
user	32m32.632s
sys	14m17.380s
