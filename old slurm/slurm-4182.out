clang++ -std=c++14 -stdlib=libc++ -O3 -ferror-limit=2 -Weverything -Wno-c++98-compat -Wno-c++98-compat-pedantic -Wno-sign-conversion -Wno-exit-time-destructors -Wno-float-equal -Wno-global-constructors -Wno-missing-declarations -Wno-unused-parameter -Wno-padded -Wno-shadow -Wno-weak-vtables -Wno-missing-prototypes -Wno-unused-variable -ferror-limit=1 -Wno-deprecated -Wno-conversion -Wno-double-promotion -c src/direct_cuda_pattern.cc -o ./obj/direct_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1
nvcc src/cuda_pattern.cu -o ./obj/_cuda_pattern.o -Iinclude -I/usr/local/cuda/include -I/usr/local/include -I/usr/include/c++/v1 -m64 -dc -gencode arch=compute_70,code=sm_70 --relocatable-device-code true  -Xptxas -v
ptxas info    : 9754 bytes gmem
ptxas info    : Compiling entry function '_Z5ZaxpymddP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZaxpymddP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 392 bytes cmem[0]
ptxas info    : Function properties for cudaGetDevice
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5DasummP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z5DasummP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 26 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z8sum_diagP7double2mdd' for 'sm_70'
ptxas info    : Function properties for _Z8sum_diagP7double2mdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 10 registers, 384 bytes cmem[0]
ptxas info    : Compiling entry function '_Z5ZgemmP7double2S0_S0_md' for 'sm_70'
ptxas info    : Function properties for _Z5ZgemmP7double2S0_S0_md
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 40 registers, 8704 bytes smem, 392 bytes cmem[0]
ptxas info    : Function properties for cudaFuncGetAttributes
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z22extract_intensity_diffP7double2PdS1_mm' for 'sm_70'
ptxas info    : Function properties for _Z22extract_intensity_diffP7double2PdS1_mm
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 392 bytes cmem[0], 8 bytes cmem[2]
ptxas info    : Compiling entry function '_Z9compose_aPdPmS_dP7double2m' for 'sm_70'
ptxas info    : Function properties for _Z9compose_aPdPmS_dP7double2m
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 30 registers, 400 bytes cmem[0]
ptxas info    : Function properties for cudaOccupancyMaxActiveBlocksPerMultiprocessor
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z5ZscalmdP7double2' for 'sm_70'
ptxas info    : Function properties for _Z5ZscalmdP7double2
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 27 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaMalloc
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm' for 'sm_70'
ptxas info    : Function properties for _Z38make_individual_pattern_intensity_diffPdS_PmS_dS0_S_S_mP7double2mm
    24 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 72 registers, 448 bytes cmem[0], 104 bytes cmem[2]
ptxas info    : Compiling entry function '_Z5ZcopymP7double2S0_' for 'sm_70'
ptxas info    : Function properties for _Z5ZcopymP7double2S0_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 376 bytes cmem[0]
ptxas info    : Function properties for cudaDeviceGetAttribute
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Compiling entry function '_Z6Dznrm2mP7double2Pd' for 'sm_70'
ptxas info    : Function properties for _Z6Dznrm2mP7double2Pd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 28 registers, 1024 bytes smem, 376 bytes cmem[0]
ptxas info    : Compiling entry function '_Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd' for 'sm_70'
ptxas info    : Function properties for _Z34extract_intensity_diff_with_offsetP7double2PdS1_S1_mmdd
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 24 registers, 416 bytes cmem[0], 8 bytes cmem[2]
nvcc -dlink ./obj/_cuda_pattern.o -arch=sm_70 -o ./obj/cuda_pattern.o -m64 -lcudadevrt -L/usr/local/cuda/lib64  -rdc=true -Xptxas -v
clang++ -o ./bin/direct_cuda_pattern ./obj/_cuda_pattern.o ./obj/direct_cuda_pattern.o ./obj/cuda_pattern.o  -lcudadevrt -lcublas -lcudart -m64 -L/usr/local/cuda/lib64  -lc++ -lc++abi -O3 -pthread
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
r : 0
Initial Ugs:

0    0.15736   0

2    -0.00109974   4.79724e-11

4    -0.00109974   1.61334e-10

6    -0.000461178   3.25869e-09

8    -0.000461178   -1.4721e-09

10    -0.00109974   -4.79724e-11

12    0.0215057   -3.81975e-09

14    0.0552805   4.93373e-09

16    0.0174135   -1.54216e-09

18    -0.00109974   -1.61334e-10

20    0.0215057   3.81975e-09

22    0.0174135   1.34334e-09

24    -0.000461178   -3.25869e-09

26    0.0552805   -4.93373e-09

28    0.0174135   -1.34334e-09

30    -0.000461178   1.4721e-09

32    0.0174135   1.54216e-09

34    0.000395632   -4.2553e-09

36    0.0552805   4.93373e-09

38    0.042788   0

40    0.016622   3.89904e-09

42    -0.000461178   3.25869e-09

44    0.016622   2.38973e-09

46    0.000395632   4.2553e-09

48    0.0366479   6.54982e-09

50    0.0552805   -4.93373e-09

52    0.016622   -2.38973e-09

54    0.042788   3.82615e-09

56    -0.00109974   4.79724e-11

58    0.0106413   0

60    0.042788   0

62    0.016622   2.38973e-09

64    -0.000308613   2.83674e-09

66    0.016622   -3.89904e-09

68    0.042788   -3.82615e-09

70    0.000395632   -4.2553e-09

72    -0.000461178   -3.25869e-09

74    0.0366479   -6.54982e-09

76    -0.00109974   -4.79724e-11

78    -0.000308613   -2.83674e-09

80    0.000395632   4.2553e-09

82    -0.000308613   -8.10342e-10

84    0.016622   -2.38973e-09

86    0.0106413   0

88    -0.000308613   8.10342e-10

90    0.016622   3.89904e-09

92    0.016622   -3.89904e-09

94    0.0366479   0

96    -0.000461178   1.4721e-09

98    0.0366479   0

100    -0.000461178   -1.4721e-09

102    -0.00109974   -1.61334e-10

104    0.0106413   2.60453e-10

106    -0.00109974   1.61334e-10

108    0.0106413   -2.60453e-10

110    -0.000722316   -4.12002e-10

112    -0.000722316   4.12002e-10

114    -0.000722316   -4.12002e-10

116    -0.000722316   4.12002e-10

118    0.0215057   3.81975e-09

120    -0.000308613   2.83674e-09

122    -0.000308613   8.10342e-10

124    0.0215057   -3.81975e-09

126    -0.000308613   -8.10342e-10

128    -0.000308613   -2.83674e-09

130    0.0174135   1.54216e-09

132    0.0174135   -1.54216e-09

134    0.0174135   1.34334e-09

136    0.0174135   -1.34334e-09
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
		breaking with new residual
Steepest Descent terminate with total step 200

solution:
(0.99599659976617815893,-0.0059626770884934638534)	
(0.0036103109747855658893,-0.011130415648521640309)	
(-0.0086364966278716127912,0.0054251956629875327728)	
(0.001825686687571596422,-0.012512514994998684761)	
(-0.0081091964701408628113,-0.0049209569926568948184)	
(-0.0017328266481307207786,-0.0081961496732247743346)	
(0.00012761706732082172275,0.038481189421236419723)	
(0.054902954351103858133,-8.7714412828433026455e-05)	
(0.0053739300576840509649,-0.021993782924614815183)	
(0.0086205149611264329096,0.010097299619577249433)	
(0.017765210730761503422,0.039160378098223348753)	
(0.0044029816971886777052,-0.020643533436591948727)	
(0.0070357290772137138363,-0.0045170316932250957273)	
(0.052994312987128422421,-0.019627443371399645039)	
(0.0020850342056817064082,-0.024424830832566902378)	
(-0.010214031425271809239,-0.016394739201679664475)	
(0.006853687303550558621,-0.020799747933325698351)	
(-0.002902065391696261043,0.0040228734169914757979)	
(0.057792906514306845167,0.011574228708004502889)	
(0.044302124260752681617,-0.00132898538404678003)	
(0.013169889647878574301,-0.023718577582949460641)	
(-0.0066491771882379001324,-0.0063314287731571624804)	
(0.016125906082289732935,-0.018252315762264069432)	
(-0.00051904552414896976652,-0.0069136983323605221557)	
(0.025348109593672771278,0.011598396918128585711)	
(0.051435145149914554552,-0.020477348390645931653)	
(0.018342737145316683617,-0.017019410480966747773)	
(0.040901333707537061712,0.019636307084557262648)	
(-0.0065666348436568501221,0.0033850351024938703758)	
(0.0089335271637412463908,0.010802662504403903396)	
(0.043776198045682203353,0.0029884381785090690167)	
(-7.440636600212916299e-06,0.01628779539164316309)	
(0.035105390349149050155,0.0074254407143798965493)	
(-0.025008232763364585116,0.017770471233594545973)	
(0.040326920781482360201,-0.010564719186092360464)	
(0.0025949811761280085556,-0.0078921523530751120507)	
(-0.012651016345154709672,-0.018830247735748879834)	
(0.030800725841640796271,-0.026513318354990510206)	
(0.0014038386864716166647,-0.0041293522020695123606)	
(0.038928513469247132128,0.0071984771978853218447)	
(0.00017267917563063594805,-0.0078694329266947599805)	
(0.032342741876122647893,0.0047859411182762535281)	
(-0.017253417085161294742,-0.0020704119904168937633)	
(0.010104461920624648041,0.015292676952371577273)	
(0.023054218654512868836,0.0057418903065148910875)	
(-0.018118762936276761044,-0.014582717247677763964)	
(-0.021321656370677968817,0.01289471540180106221)	
(0.033174679300277065686,0.014642526849839479497)	
(-0.0027453508229250953888,-0.0090844875018918583992)	
(0.040801871303322252704,-0.0097317947573663313166)	
(0.0042011306794123640107,-0.0056644780971518019289)	
(0.0039285917068609876521,-0.001462731106023131564)	
(0.010296701648409300328,0.014693747255566229695)	
(0.014524066411819535477,-0.0023805439967277252505)	
(0.0021542860629473930059,0.016140652675775434)	
(0.0087257881518293285705,0.0071886557379454490632)	
(0.018842141014786057546,0.0013474228130623345026)	
(0.025282433724926903218,-0.005939118269154135786)	
(0.019843249593033056993,-0.0051744941781435242062)	
(0.0064386635848751811242,0.024746085483090415891)	
(0.036640615942687006223,0.00199839648068584003)	
(0.025616076060849767709,0.0048838182983830863079)	
(-0.00052676318414313148646,0.027792953307901699378)	
(0.031994479212684577563,0.0039903126602486528249)	
(0.036523017474420826911,7.1658301419377817181e-05)	
(0.0046612723670003929077,-0.021495371231429978576)	
(0.0060912604208125257013,-0.022544815967489129777)	
(0.0026088610585953352604,-0.021640111383316434218)	
(0.0022118067840850726656,-0.020127874969898568169)	


real	10m24.238s
user	6m39.868s
sys	2m57.628s
